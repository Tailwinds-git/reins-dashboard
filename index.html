<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>東京都6区 不動産相場分析ダッシュボード</title>
    <!-- フォント読み込み -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,500;0,600;0,700;1,400&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;1,9..40,400&family=Noto+Sans+JP:wght@300;400;500;600;700&family=Shippori+Mincho:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- 外部CSS -->
    <link rel="stylesheet" href="css/style.css">
</head>
</head>
<body>
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading</div>
    </div>

    <header>
        <div class="header-inner">
            <div class="header-brand">
                <span class="header-brand-main">REINS<br><span style="font-family: var(--font-ui); font-size: 0.65rem; font-weight: 500; letter-spacing: 0.1em; color: var(--text-muted);">DASHBOARD</span></span>
            </div>
            <nav class="header-nav">
                <span class="nav-link active" data-section="overview">在庫統計</span>
                <span class="nav-link" data-section="overviewSeller">在庫統計(売主)</span>
                <span class="nav-link" data-section="seller">商号別ランキング</span>
                <span class="nav-link" data-section="propertyList">在庫物件リスト</span>
                <span class="nav-link" data-section="soldList">成約統計</span>
                <span class="nav-link" data-section="soldListSeller">成約統計(売主)</span>
                <span class="nav-link" data-section="updateList">成約済み・更新</span>
            </nav>
            <div class="header-right">
                <div class="hamburger" id="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <div class="header-divider"></div>
                <div class="header-user">
                    <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                </div>
            </div>
        </div>
        <div class="mobile-menu" id="mobileMenu">
            <div class="mobile-nav-link active" data-section="overview">在庫統計</div>
            <div class="mobile-nav-link" data-section="overviewSeller">在庫統計(売主)</div>
            <div class="mobile-nav-link" data-section="seller">商号別ランキング</div>
            <div class="mobile-nav-link" data-section="propertyList">在庫物件リスト</div>
            <div class="mobile-nav-link" data-section="soldList">成約統計</div>
            <div class="mobile-nav-link" data-section="soldListSeller">成約統計(売主)</div>
            <div class="mobile-nav-link" data-section="updateList">成約済み物件・更新物件リスト</div>
        </div>
    </header>

    <div class="container">
        <!-- 在庫統計セクション -->
        <div id="overview" class="section active">
            <!-- 在庫統計用フィルター -->
            <div class="filter-section" id="stats-filter-section">
                <div class="filter-header" onclick="toggleFilter('stats-filter-section')">
                    <div class="filter-title">統計フィルター</div>
                    <div class="filter-toggle">
                        <svg viewBox="0 0 24 24"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
                    </div>
                </div>
                <div class="filter-content">
                    <div class="filter-grid">
                        <div class="filter-group">
                            <label>取引態様</label>
                            <select id="stats-filter-torihiki">
                                <option value="">すべて</option>
                                <option value="売主">売主</option>
                                <option value="専任">専任</option>
                                <option value="専属">専属</option>
                                <option value="一般">一般</option>
                                <option value="代理">代理</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>区</label>
                            <select id="stats-filter-district">
                                <option value="">全区</option>
                                <option value="港区">港区</option>
                                <option value="中央区">中央区</option>
                                <option value="千代田区">千代田区</option>
                                <option value="渋谷区">渋谷区</option>
                                <option value="新宿区">新宿区</option>
                                <option value="文京区">文京区</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>間取</label>
                            <select id="stats-filter-layout">
                                <option value="">すべて</option>
                                <option value="1R">1R</option>
                                <option value="1K">1K</option>
                                <option value="1DK">1DK</option>
                                <option value="1LDK">1LDK</option>
                                <option value="2K">2K</option>
                                <option value="2DK">2DK</option>
                                <option value="2LDK">2LDK</option>
                                <option value="3K">3K</option>
                                <option value="3DK">3DK</option>
                                <option value="3LDK">3LDK</option>
                                <option value="4LDK">4LDK</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>価格（万円）</label>
                            <select id="stats-filter-price">
                                <option value="">すべて</option>
                                <option value="0-5000">～5,000万円</option>
                                <option value="5000-10000">5,000～10,000万円</option>
                                <option value="10000-15000">10,000～15,000万円</option>
                                <option value="15000-20000">15,000～20,000万円</option>
                                <option value="20000-25000">20,000～25,000万円</option>
                                <option value="25000-30000">25,000～30,000万円</option>
                                <option value="30000-">30,000万円～</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>専有面積（坪）</label>
                            <select id="stats-filter-area">
                                <option value="">すべて</option>
                                <option value="0-10">～10坪</option>
                                <option value="10-15">10～15坪</option>
                                <option value="15-20">15～20坪</option>
                                <option value="20-25">20～25坪</option>
                                <option value="25-30">25～30坪</option>
                                <option value="30-35">30～35坪</option>
                                <option value="35-40">35～40坪</option>
                                <option value="40-">40坪～</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>築年数</label>
                            <select id="stats-filter-age">
                                <option value="">すべて</option>
                                <option value="0-5">～5年</option>
                                <option value="5-10">5～10年</option>
                                <option value="10-15">10～15年</option>
                                <option value="15-20">15～20年</option>
                                <option value="20-25">20～25年</option>
                                <option value="25-30">25～30年</option>
                                <option value="30-">30年～</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <button class="btn btn-primary" onclick="applyStatsFilter()">適用</button>
                        </div>
                        <div class="filter-group">
                            <button class="btn btn-outline" onclick="resetStatsFilter()">リセット</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- フィルター適用状態表示 -->
            <div id="stats-filter-badge" class="filter-active-badge" style="display:none;">
                フィルター適用中: <span class="count" id="stats-filtered-count">0</span>件 / 全<span id="stats-total-count">0</span>件
            </div>

            <div class="card">
                <div class="card-title">統計サマリー</div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">価格（万円）平均</div>
                        <div class="stat-value" id="stat-price-avg">-</div>
                        <div class="stat-detail" id="stat-price-detail">-</div>
                    </div>
                    <div class="stat-card secondary">
                        <div class="stat-label">専有面積（坪）平均</div>
                        <div class="stat-value" id="stat-area-avg">-</div>
                        <div class="stat-detail" id="stat-area-detail">-</div>
                    </div>
                    <div class="stat-card accent">
                        <div class="stat-label">坪単価（万円）平均</div>
                        <div class="stat-value" id="stat-sqm-avg">-</div>
                        <div class="stat-detail" id="stat-sqm-detail">-</div>
                    </div>
                    <div class="stat-card info">
                        <div class="stat-label">物件数</div>
                        <div class="stat-value"><span id="stat-count">-</span><span class="stat-unit">件</span></div>
                    </div>
                </div>

                <div class="card-title" style="margin-top:20px;">区別統計</div>
                <div class="table-container" style="max-height:none;">
                    <table class="district-table">
                        <thead><tr><th>区</th><th class="text-right">物件数</th><th class="text-right">平均価格（万円）</th><th class="text-right">中央値価格（万円）</th><th class="text-right">平均面積（坪）</th></tr></thead>
                        <tbody id="district-stats-body"></tbody>
                    </table>
                </div>
            </div>

            <div class="charts-grid">
                <div class="card">
                    <div class="card-title">価格分布</div>
                    <div class="chart-container"><canvas id="priceDistChart"></canvas></div>
                </div>
                <div class="card">
                    <div class="card-title">区別物件数</div>
                    <div class="chart-container"><canvas id="districtChart"></canvas></div>
                </div>
            </div>
            <div class="charts-grid">
                <div class="card">
                    <div class="card-title">専有面積（坪） vs 価格（全件）</div>
                    <div class="chart-container"><canvas id="scatterAreaChart"></canvas></div>
                </div>
                <div class="card">
                    <div class="card-title">築年数 vs 価格（全件）</div>
                    <div class="chart-container"><canvas id="scatterAgeChart"></canvas></div>
                </div>
            </div>
        </div>

        <!-- 在庫統計（売主）セクション -->
        <div id="overviewSeller" class="section">
            <!-- 売主在庫統計用フィルター -->
            <div class="filter-section" id="seller-stats-filter-section">
                <div class="filter-header" onclick="toggleFilter('seller-stats-filter-section')">
                    <div class="filter-title">フィルター</div>
                    <div class="filter-toggle">
                        <svg viewBox="0 0 24 24"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
                    </div>
                </div>
                <div class="filter-content">
                    <div class="filter-grid">
                        <div class="filter-group">
                            <label>区</label>
                            <select id="sellerStatsWardFilter">
                                <option value="">すべて</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>間取り</label>
                            <select id="sellerStatsLayoutFilter">
                                <option value="">すべて</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>価格帯</label>
                            <select id="sellerStatsPriceFilter">
                                <option value="">すべて</option>
                                <option value="0-3000">〜3,000万円</option>
                                <option value="3000-5000">3,000〜5,000万円</option>
                                <option value="5000-7000">5,000〜7,000万円</option>
                                <option value="7000-10000">7,000〜1億円</option>
                                <option value="10000-">1億円〜</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>専有面積</label>
                            <select id="sellerStatsAreaFilter">
                                <option value="">すべて</option>
                                <option value="0-40">〜40㎡</option>
                                <option value="40-60">40〜60㎡</option>
                                <option value="60-80">60〜80㎡</option>
                                <option value="80-100">80〜100㎡</option>
                                <option value="100-">100㎡〜</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>築年数</label>
                            <select id="sellerStatsAgeFilter">
                                <option value="">すべて</option>
                                <option value="0-5">〜5年</option>
                                <option value="5-10">5〜10年</option>
                                <option value="10-20">10〜20年</option>
                                <option value="20-30">20〜30年</option>
                                <option value="30-">30年〜</option>
                            </select>
                        </div>
                    </div>
                    <div class="filter-actions">
                        <button class="btn btn-secondary" onclick="resetSellerStatsFilter()">リセット</button>
                        <button class="btn btn-primary" onclick="applySellerStatsFilter()">適用</button>
                    </div>
                </div>
            </div>

            <!-- 売主統計サマリー -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="sellerTotalCount">-</div>
                    <div class="stat-label">総物件数</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="sellerAvgPrice">-</div>
                    <div class="stat-label">平均価格</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="sellerAvgArea">-</div>
                    <div class="stat-label">平均面積</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="sellerAvgUnitPrice">-</div>
                    <div class="stat-label">平均坪単価</div>
                </div>
            </div>

            <!-- 売主区別統計テーブル -->
            <div class="card">
                <div class="card-title">区別統計（売主物件）</div>
                <div class="table-wrapper">
                    <table id="sellerWardStatsTable">
                        <thead>
                            <tr>
                                <th>区</th>
                                <th>物件数</th>
                                <th>平均価格</th>
                                <th>平均面積</th>
                                <th>平均坪単価</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- 売主チャート -->
            <div class="chart-grid">
                <div class="card">
                    <div class="card-title">区別物件数（売主）</div>
                    <div class="chart-container"><canvas id="sellerWardChart"></canvas></div>
                </div>
                <div class="card">
                    <div class="card-title">価格帯分布（売主）</div>
                    <div class="chart-container"><canvas id="sellerPriceChart"></canvas></div>
                </div>
                <div class="card">
                    <div class="card-title">間取り別分布（売主）</div>
                    <div class="chart-container"><canvas id="sellerLayoutChart"></canvas></div>
                </div>
                <div class="card">
                    <div class="card-title">築年数 vs 価格（売主）</div>
                    <div class="chart-container"><canvas id="sellerScatterAgeChart"></canvas></div>
                </div>
            </div>
        </div>

        <!-- 売主物件セクション -->
        <div id="seller" class="section">
            <!-- 商号別ランキング用フィルター -->
            <div class="filter-section" id="seller-filter-section">
                <div class="filter-header" onclick="toggleFilter('seller-filter-section')">
                    <div class="filter-title">フィルター</div>
                    <div class="filter-toggle">
                        <svg viewBox="0 0 24 24"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
                    </div>
                </div>
                <div class="filter-content">
                    <div class="filter-grid">
                        <div class="filter-group">
                            <label>区</label>
                            <select id="seller-filter-district">
                                <option value="">全区</option>
                                <option value="港区">港区</option>
                                <option value="中央区">中央区</option>
                                <option value="千代田区">千代田区</option>
                                <option value="渋谷区">渋谷区</option>
                                <option value="新宿区">新宿区</option>
                                <option value="文京区">文京区</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>取引態様</label>
                            <select id="seller-filter-torihiki">
                                <option value="">すべて</option>
                                <option value="売主">売主</option>
                                <option value="専任">専任</option>
                                <option value="専属">専属</option>
                                <option value="一般">一般</option>
                                <option value="代理">代理</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <button class="btn btn-primary" onclick="applySellerFilter()">適用</button>
                        </div>
                        <div class="filter-group">
                            <button class="btn btn-outline" onclick="resetSellerFilter()">リセット</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- フィルター適用状態表示 -->
            <div id="seller-filter-badge" class="filter-active-badge" style="display:none;">
                フィルター適用中: <span class="count" id="seller-filtered-count">0</span>件 / 全<span id="seller-total-count">0</span>件
            </div>

            <div class="seller-stats">
                <div class="seller-stat"><div class="seller-stat-value" id="seller-company-count">-<span class="stat-unit">社</span></div><div class="seller-stat-label">対象物件を扱う商号数</div></div>
                <div class="seller-stat"><div class="seller-stat-value" id="seller-total-amount">-<span class="stat-unit">億円</span></div><div class="seller-stat-label">対象物件総額</div></div>
                <div class="seller-stat"><div class="seller-stat-value" id="seller-property-count">-<span class="stat-unit">件</span></div><div class="seller-stat-label">対象物件数</div></div>
            </div>
            <div class="charts-grid">
                <div class="card"><div class="card-title" id="seller-total-chart-title">在庫物件総額 TOP15</div><div class="chart-container"><canvas id="sellerTotalChart"></canvas></div></div>
                <div class="card"><div class="card-title" id="seller-count-chart-title">在庫物件数 TOP15</div><div class="chart-container"><canvas id="sellerCountChart"></canvas></div></div>
            </div>
            <div class="card">
                <div class="card-title" id="seller-ranking-title">在庫物件 商号別詳細ランキング</div>
                <div class="ranking-tabs">
                    <button class="ranking-tab active" data-sort="total">在庫物件総額(億円) ▼</button>
                    <button class="ranking-tab" data-sort="count">在庫物件数</button>
                    <button class="ranking-tab" data-sort="avg">平均単価(万円)</button>
                </div>
                <div class="table-container"><table><thead><tr><th>順位</th><th>商号</th><th class="text-right">総額(億円)</th><th class="text-right">件数</th><th class="text-right">平均(万円)</th></tr></thead><tbody id="sellerRankingBody"></tbody></table></div>
            </div>
        </div>

        <!-- 掲載物件リストセクション -->
        <div id="propertyList" class="section">
            <div class="filter-section" id="pl-filter-section">
                <div class="filter-header" onclick="toggleFilter('pl-filter-section')">
                    <div class="filter-title">フィルター</div>
                    <div class="filter-toggle">
                        <svg viewBox="0 0 24 24"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
                    </div>
                </div>
                <div class="filter-content">
                    <div class="filter-grid">
                        <div class="filter-group"><label>区</label><select id="pl-filter-district"><option value="">全区</option><option value="港区">港区</option><option value="中央区">中央区</option><option value="千代田区">千代田区</option><option value="渋谷区">渋谷区</option><option value="新宿区">新宿区</option><option value="文京区">文京区</option></select></div>
                        <div class="filter-group">
                            <label>取引形態</label>
                            <select id="pl-filter-torihiki">
                                <option value="">すべて</option>
                                <option value="売主">売主</option>
                                <option value="専任">専任</option>
                                <option value="専属">専属</option>
                                <option value="一般">一般</option>
                                <option value="代理">代理</option>
                            </select>
                        </div>
                        <div class="filter-group"><label>建物名</label><input type="text" id="pl-filter-building" placeholder="部分一致"></div>
                        <div class="filter-group"><label>商号</label><input type="text" id="pl-filter-company" placeholder="部分一致"></div>
                        <div class="filter-group">
                            <label>間取</label>
                            <select id="pl-filter-layout">
                                <option value="">すべて</option>
                                <option value="1R">1R</option>
                                <option value="1K">1K</option>
                                <option value="1DK">1DK</option>
                                <option value="1LDK">1LDK</option>
                                <option value="2K">2K</option>
                                <option value="2DK">2DK</option>
                                <option value="2LDK">2LDK</option>
                                <option value="3K">3K</option>
                                <option value="3DK">3DK</option>
                                <option value="3LDK">3LDK</option>
                                <option value="4LDK">4LDK</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>価格（万円）</label>
                            <select id="pl-filter-price">
                                <option value="">すべて</option>
                                <option value="0-5000">～5,000万円</option>
                                <option value="5000-10000">5,000～10,000万円</option>
                                <option value="10000-15000">10,000～15,000万円</option>
                                <option value="15000-20000">15,000～20,000万円</option>
                                <option value="20000-25000">20,000～25,000万円</option>
                                <option value="25000-30000">25,000～30,000万円</option>
                                <option value="30000-">30,000万円～</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>専有面積（坪）</label>
                            <select id="pl-filter-area">
                                <option value="">すべて</option>
                                <option value="0-10">～10坪</option>
                                <option value="10-15">10～15坪</option>
                                <option value="15-20">15～20坪</option>
                                <option value="20-25">20～25坪</option>
                                <option value="25-30">25～30坪</option>
                                <option value="30-35">30～35坪</option>
                                <option value="35-40">35～40坪</option>
                                <option value="40-">40坪～</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>築年数</label>
                            <select id="pl-filter-age">
                                <option value="">すべて</option>
                                <option value="0-5">～5年</option>
                                <option value="5-10">5～10年</option>
                                <option value="10-15">10～15年</option>
                                <option value="15-20">15～20年</option>
                                <option value="20-25">20～25年</option>
                                <option value="25-30">25～30年</option>
                                <option value="30-">30年～</option>
                            </select>
                        </div>
                        <div class="filter-group"><button class="btn btn-primary" onclick="applyPropertyFilter()">適用</button></div>
                        <div class="filter-group"><button class="btn btn-outline" onclick="resetPropertyFilter()">リセット</button></div>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="results-count">
                    <div>検索結果: <strong id="pl-result-count">0</strong>件 <span id="pl-filter-notice" style="color:var(--accent-gold);margin-left:12px;"></span></div>
                    <div style="display:flex;gap:12px;align-items:center;">
                        <select class="sort-select" id="pl-sort-select" onchange="sortPropertyList()">
                            <option value="id-asc">物件番号 昇順</option>
                            <option value="id-desc">物件番号 降順</option>
                            <option value="price-asc">価格 安い順</option>
                            <option value="price-desc">価格 高い順</option>
                            <option value="area-asc">面積 小さい順</option>
                            <option value="area-desc">面積 大きい順</option>
                        </select>
                        <button class="export-btn" onclick="exportPropertyCSV()">📥 CSV出力</button>
                    </div>
                </div>
                <div class="table-container"><table><thead><tr><th>物件番号</th><th>区</th><th>建物名</th><th>階</th><th>間取</th><th class="text-right">価格</th><th class="text-right">面積</th><th class="text-right">築年</th><th>状況</th><th>商号</th></tr></thead><tbody id="propertyListBody"></tbody></table></div>
                <div class="pagination" id="pl-pagination"></div>
            </div>
        </div>

        <!-- 成約済み物件・更新物件リストセクション -->
        <div id="updateList" class="section">
            <!-- 成約済み物件リスト -->
            <div class="card">
                <div class="card-title">成約済み物件リスト - 掲載終了（成約済み）となった物件</div>
                <p style="color:var(--text-secondary);font-size:0.85rem;margin-bottom:20px;">※differences_master.csvの差分種別「削除」を成約済みとして表示しています（物件詳細は参照元ファイルから取得）</p>
                
                <!-- 成約済み物件リスト用フィルター -->
                <div class="filter-section" id="sold-list-filter-section" style="margin-bottom:16px;box-shadow:none;padding:16px;background:var(--bg-main);">
                    <div class="filter-header" onclick="toggleFilter('sold-list-filter-section')">
                        <div class="filter-title" style="font-size:0.9rem;margin-bottom:0;">フィルター</div>
                        <div class="filter-toggle">
                            <svg viewBox="0 0 24 24"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
                        </div>
                    </div>
                    <div class="filter-content">
                        <div class="filter-grid">
                            <div class="filter-group"><label>区</label><select id="sold-list-filter-district"><option value="">全区</option><option value="港区">港区</option><option value="中央区">中央区</option><option value="千代田区">千代田区</option><option value="渋谷区">渋谷区</option><option value="新宿区">新宿区</option><option value="文京区">文京区</option></select></div>
                            <div class="filter-group"><label>建物名</label><input type="text" id="sold-list-filter-building" placeholder="部分一致"></div>
                            <div class="filter-group"><label>商号</label><input type="text" id="sold-list-filter-company" placeholder="部分一致"></div>
                            <div class="filter-group">
                                <label>間取</label>
                                <select id="sold-list-filter-layout">
                                    <option value="">すべて</option>
                                    <option value="1R">1R</option>
                                    <option value="1K">1K</option>
                                    <option value="1DK">1DK</option>
                                    <option value="1LDK">1LDK</option>
                                    <option value="2K">2K</option>
                                    <option value="2DK">2DK</option>
                                    <option value="2LDK">2LDK</option>
                                    <option value="3K">3K</option>
                                    <option value="3DK">3DK</option>
                                    <option value="3LDK">3LDK</option>
                                    <option value="4LDK">4LDK</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label>価格（万円）</label>
                                <select id="sold-list-filter-price">
                                    <option value="">すべて</option>
                                    <option value="0-5000">～5,000万円</option>
                                    <option value="5000-10000">5,000～10,000万円</option>
                                    <option value="10000-15000">10,000～15,000万円</option>
                                    <option value="15000-20000">15,000～20,000万円</option>
                                    <option value="20000-25000">20,000～25,000万円</option>
                                    <option value="25000-30000">25,000～30,000万円</option>
                                    <option value="30000-">30,000万円～</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label>専有面積（坪）</label>
                                <select id="sold-list-filter-area">
                                    <option value="">すべて</option>
                                    <option value="0-10">～10坪</option>
                                    <option value="10-15">10～15坪</option>
                                    <option value="15-20">15～20坪</option>
                                    <option value="20-25">20～25坪</option>
                                    <option value="25-30">25～30坪</option>
                                    <option value="30-35">30～35坪</option>
                                    <option value="35-40">35～40坪</option>
                                    <option value="40-">40坪～</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label>築年数</label>
                                <select id="sold-list-filter-age">
                                    <option value="">すべて</option>
                                    <option value="0-5">～5年</option>
                                    <option value="5-10">5～10年</option>
                                    <option value="10-15">10～15年</option>
                                    <option value="15-20">15～20年</option>
                                    <option value="20-25">20～25年</option>
                                    <option value="25-30">25～30年</option>
                                    <option value="30-">30年～</option>
                                </select>
                            </div>
                            <div class="filter-group"><button class="btn btn-primary" onclick="applySoldListFilter()">適用</button></div>
                            <div class="filter-group"><button class="btn btn-outline" onclick="resetSoldListFilter()">リセット</button></div>
                        </div>
                    </div>
                </div>
                
                <div class="results-count">
                    <div>成約済み物件数: <strong id="sold-result-count">0</strong>件 <span id="sold-list-filter-notice" style="color:var(--accent-gold);margin-left:12px;"></span></div>
                    <div style="display:flex;gap:12px;align-items:center;">
                        <select class="sort-select" id="sold-sort-select" onchange="sortSoldList()">
                            <option value="soldDate-desc">成約日 新しい順</option>
                            <option value="soldDate-asc">成約日 古い順</option>
                            <option value="id-desc">物件番号 降順</option>
                            <option value="id-asc">物件番号 昇順</option>
                            <option value="price-desc">価格 高い順</option>
                            <option value="price-asc">価格 安い順</option>
                        </select>
                        <button class="export-btn" onclick="exportSoldCSV()">📥 CSV出力</button>
                    </div>
                </div>
                <div class="table-container"><table><thead><tr><th>成約日</th><th>物件番号</th><th>区</th><th>建物名</th><th>階</th><th>間取</th><th class="text-right">価格</th><th class="text-right">面積</th><th class="text-right">築年</th><th>商号</th></tr></thead><tbody id="soldListBody"></tbody></table></div>
                <div class="pagination" id="sold-pagination"></div>
            </div>

            <!-- 更新物件リスト -->
            <div class="card">
                <div class="card-title">更新物件リスト - 情報更新があった物件</div>
                <div class="time-filter-buttons">
                    <button class="time-btn active" data-period="yesterday">昨日から</button>
                    <button class="time-btn" data-period="week">1週間前から</button>
                    <button class="time-btn" data-period="month">1か月前から</button>
                </div>
                <p style="color:var(--text-secondary);font-size:0.85rem;margin-bottom:20px;">※differences_master.csvの差分種別「更新」およびdifferences_updates.csvから更新情報を取得しています</p>
                <div class="results-count"><div>更新物件数: <strong id="ul-result-count">0</strong>件</div></div>
                <div class="table-container"><table><thead><tr><th>物件番号</th><th>建物名</th><th>更新内容</th><th>変更前</th><th>変更後</th><th>備考</th></tr></thead><tbody id="updateListBody"></tbody></table></div>
            </div>
        </div>

        <!-- 成約済み物件セクション -->
        <div id="soldList" class="section">
            <!-- 期間表示切替 -->
            <div class="filter-section" style="margin-bottom:16px;">
                <div class="filter-title">期間表示切替</div>
                <div class="period-selector">
                    <div class="period-unit-selector">
                        <label>表示単位</label>
                        <div class="period-unit-buttons">
                            <button class="period-unit-btn active" data-unit="all" onclick="changePeriodUnit('all')">全期間</button>
                            <button class="period-unit-btn" data-unit="day" onclick="changePeriodUnit('day')">日単位</button>
                            <button class="period-unit-btn" data-unit="week" onclick="changePeriodUnit('week')">週単位</button>
                            <button class="period-unit-btn" data-unit="month" onclick="changePeriodUnit('month')">月単位</button>
                        </div>
                    </div>
                    <div class="period-value-selector" id="period-value-container" style="display:none;">
                        <label id="period-value-label">期間選択</label>
                        <div id="period-value-input"></div>
                    </div>
                    <div class="period-display" id="period-display">
                        <span class="period-display-label">表示期間:</span>
                        <span class="period-display-value" id="period-display-value">全期間</span>
                    </div>
                </div>
            </div>

            <!-- 成約済み物件用フィルター -->
            <div class="filter-section" id="sold-filter-section">
                <div class="filter-header" onclick="toggleFilter('sold-filter-section')">
                    <div class="filter-title">検索条件</div>
                    <div class="filter-toggle">
                        <svg viewBox="0 0 24 24"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
                    </div>
                </div>
                <div class="filter-content">
                    <div class="filter-grid">
                        <div class="filter-group">
                            <label>取引態様</label>
                            <select id="sold-filter-torihiki">
                                <option value="">すべて</option>
                                <option value="売主">売主</option>
                                <option value="専任">専任</option>
                                <option value="専属">専属</option>
                                <option value="一般">一般</option>
                                <option value="代理">代理</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>区</label>
                            <select id="sold-filter-district">
                                <option value="">全区</option>
                                <option value="港区">港区</option>
                                <option value="中央区">中央区</option>
                                <option value="千代田区">千代田区</option>
                                <option value="渋谷区">渋谷区</option>
                                <option value="新宿区">新宿区</option>
                                <option value="文京区">文京区</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>建物名</label>
                            <input type="text" id="sold-filter-building" placeholder="部分一致">
                        </div>
                        <div class="filter-group">
                            <label>間取</label>
                            <select id="sold-filter-layout">
                                <option value="">すべて</option>
                                <option value="1R">1R</option>
                                <option value="1K">1K</option>
                                <option value="1DK">1DK</option>
                                <option value="1LDK">1LDK</option>
                                <option value="2K">2K</option>
                                <option value="2DK">2DK</option>
                                <option value="2LDK">2LDK</option>
                                <option value="3K">3K</option>
                                <option value="3DK">3DK</option>
                                <option value="3LDK">3LDK</option>
                                <option value="4LDK">4LDK</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>価格（万円）</label>
                            <select id="sold-filter-price">
                                <option value="">すべて</option>
                                <option value="0-5000">～5,000万円</option>
                                <option value="5000-10000">5,000～10,000万円</option>
                                <option value="10000-15000">10,000～15,000万円</option>
                                <option value="15000-20000">15,000～20,000万円</option>
                                <option value="20000-25000">20,000～25,000万円</option>
                                <option value="25000-30000">25,000～30,000万円</option>
                                <option value="30000-">30,000万円～</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>専有面積（坪）</label>
                            <select id="sold-filter-area">
                                <option value="">すべて</option>
                                <option value="0-10">～10坪</option>
                                <option value="10-15">10～15坪</option>
                                <option value="15-20">15～20坪</option>
                                <option value="20-25">20～25坪</option>
                                <option value="25-30">25～30坪</option>
                                <option value="30-35">30～35坪</option>
                                <option value="35-40">35～40坪</option>
                                <option value="40-">40坪～</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>築年数</label>
                            <select id="sold-filter-age">
                                <option value="">すべて</option>
                                <option value="0-5">～5年</option>
                                <option value="5-10">5～10年</option>
                                <option value="10-15">10～15年</option>
                                <option value="15-20">15～20年</option>
                                <option value="20-25">20～25年</option>
                                <option value="25-30">25～30年</option>
                                <option value="30-">30年～</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <button class="btn btn-primary" onclick="applySoldFilter()">検索</button>
                        </div>
                        <div class="filter-group">
                            <button class="btn btn-outline" onclick="resetSoldFilter()">リセット</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- フィルター適用状態表示 -->
            <div id="sold-filter-badge" class="filter-active-badge" style="display:none;">
                フィルター適用中: <span class="count" id="sold-filtered-count">0</span>件 / 全<span id="sold-total-count">0</span>件
            </div>

            <!-- 成約統計サマリー -->
            <div class="card">
                <div class="card-title">成約統計サマリー</div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">成約件数</div>
                        <div class="stat-value"><span id="sold-stat-count">-</span><span class="stat-unit">件</span></div>
                    </div>
                    <div class="stat-card secondary">
                        <div class="stat-label">成約総額</div>
                        <div class="stat-value" id="sold-stat-total">-</div>
                        <div class="stat-unit">億円</div>
                    </div>
                    <div class="stat-card accent">
                        <div class="stat-label">平均成約価格</div>
                        <div class="stat-value" id="sold-stat-avg-price">-</div>
                        <div class="stat-detail" id="sold-stat-price-detail">-</div>
                    </div>
                    <div class="stat-card info">
                        <div class="stat-label">平均坪単価</div>
                        <div class="stat-value" id="sold-stat-avg-sqm">-</div>
                        <div class="stat-detail" id="sold-stat-sqm-detail">-</div>
                    </div>
                </div>
            </div>

            <!-- 成約統計グラフ -->
            <div class="charts-grid">
                <div class="card">
                    <div class="card-title">区別成約分布</div>
                    <div class="chart-container"><canvas id="soldDistrictChart"></canvas></div>
                </div>
                <div class="card">
                    <div class="card-title">価格帯別成約件数</div>
                    <div class="chart-container"><canvas id="soldPriceRangeChart"></canvas></div>
                </div>
            </div>
            <div class="charts-grid">
                <div class="card">
                    <div class="card-title">成約推移（日別）</div>
                    <div class="chart-container"><canvas id="soldTrendChart"></canvas></div>
                </div>
                <div class="card">
                    <div class="card-title">間取別成約分布</div>
                    <div class="chart-container"><canvas id="soldLayoutChart"></canvas></div>
                </div>
            </div>
            <div class="charts-grid">
                <div class="card">
                    <div class="card-title">面積帯別（坪）成約件数</div>
                    <div class="chart-container"><canvas id="soldAreaRangeChart"></canvas></div>
                </div>
                <div class="card">
                    <div class="card-title">専有面積（坪） vs 価格（成約物件）</div>
                    <div class="chart-container"><canvas id="soldScatterAreaChart"></canvas></div>
                </div>
            </div>

            <!-- 商号別成約ランキング -->
            <div class="charts-grid">
                <div class="card">
                    <div class="card-title">成約物件総額 商号TOP15</div>
                    <div class="chart-container"><canvas id="soldSellerTotalChart"></canvas></div>
                </div>
                <div class="card">
                    <div class="card-title">成約物件数 商号TOP15</div>
                    <div class="chart-container"><canvas id="soldSellerCountChart"></canvas></div>
                </div>
            </div>
        </div>

        <!-- 成約統計（売主）セクション -->
        <div id="soldListSeller" class="section">
            <!-- 期間表示切替 -->
            <div class="filter-section" style="margin-bottom:16px;">
                <div class="filter-title">期間表示切替</div>
                <div class="period-selector">
                    <div class="period-unit-selector">
                        <label>表示単位</label>
                        <div class="period-unit-buttons">
                            <button class="period-unit-btn active" data-unit="all" onclick="changeSellerSoldPeriodUnit('all')">全期間</button>
                            <button class="period-unit-btn" data-unit="day" onclick="changeSellerSoldPeriodUnit('day')">日単位</button>
                            <button class="period-unit-btn" data-unit="week" onclick="changeSellerSoldPeriodUnit('week')">週単位</button>
                            <button class="period-unit-btn" data-unit="month" onclick="changeSellerSoldPeriodUnit('month')">月単位</button>
                        </div>
                    </div>
                    <div class="period-value-selector" id="seller-period-value-container" style="display:none;">
                        <label id="seller-period-value-label">期間選択</label>
                        <div id="seller-period-value-input"></div>
                    </div>
                    <div class="period-display" id="seller-period-display">
                        <span class="period-display-label">表示期間:</span>
                        <span class="period-display-value" id="seller-period-display-value">全期間</span>
                    </div>
                </div>
            </div>

            <!-- 売主成約物件用フィルター -->
            <div class="filter-section" id="seller-sold-filter-section">
                <div class="filter-header" onclick="toggleFilter('seller-sold-filter-section')">
                    <div class="filter-title">検索条件</div>
                    <div class="filter-toggle">
                        <svg viewBox="0 0 24 24"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
                    </div>
                </div>
                <div class="filter-content">
                    <div class="filter-grid">
                        <div class="filter-group">
                            <label>区</label>
                            <select id="seller-sold-filter-district">
                                <option value="">全区</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>間取り</label>
                            <select id="seller-sold-filter-layout">
                                <option value="">すべて</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>価格帯</label>
                            <select id="seller-sold-filter-price">
                                <option value="">すべて</option>
                                <option value="0-3000">〜3,000万円</option>
                                <option value="3000-5000">3,000〜5,000万円</option>
                                <option value="5000-7000">5,000〜7,000万円</option>
                                <option value="7000-10000">7,000〜1億円</option>
                                <option value="10000-">1億円〜</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>専有面積</label>
                            <select id="seller-sold-filter-area">
                                <option value="">すべて</option>
                                <option value="0-40">〜40㎡</option>
                                <option value="40-60">40〜60㎡</option>
                                <option value="60-80">60〜80㎡</option>
                                <option value="80-100">80〜100㎡</option>
                                <option value="100-">100㎡〜</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>築年数</label>
                            <select id="seller-sold-filter-age">
                                <option value="">すべて</option>
                                <option value="0-5">〜5年</option>
                                <option value="5-10">5〜10年</option>
                                <option value="10-20">10〜20年</option>
                                <option value="20-30">20〜30年</option>
                                <option value="30-">30年〜</option>
                            </select>
                        </div>
                    </div>
                    <div class="filter-actions">
                        <button class="btn btn-secondary" onclick="resetSellerSoldFilter()">リセット</button>
                        <button class="btn btn-primary" onclick="applySellerSoldFilter()">適用</button>
                    </div>
                </div>
            </div>

            <!-- 売主成約統計サマリー -->
            <div class="sold-stats-summary">
                <div class="sold-stats-grid">
                    <div class="stat-card primary">
                        <div class="stat-label">成約件数</div>
                        <div class="stat-value" id="seller-sold-stat-count">-</div>
                        <div class="stat-detail" id="seller-sold-stat-count-detail">-</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-label">成約総額</div>
                        <div class="stat-value" id="seller-sold-stat-total">-</div>
                        <div class="stat-detail" id="seller-sold-stat-total-detail">-</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-label">平均成約価格</div>
                        <div class="stat-value" id="seller-sold-stat-avg">-</div>
                        <div class="stat-detail" id="seller-sold-stat-avg-detail">-</div>
                    </div>
                    <div class="stat-card info">
                        <div class="stat-label">平均坪単価</div>
                        <div class="stat-value" id="seller-sold-stat-avg-sqm">-</div>
                        <div class="stat-detail" id="seller-sold-stat-sqm-detail">-</div>
                    </div>
                </div>
            </div>

            <!-- 売主成約統計グラフ -->
            <div class="charts-grid">
                <div class="card">
                    <div class="card-title">区別成約分布（売主）</div>
                    <div class="chart-container"><canvas id="sellerSoldDistrictChart"></canvas></div>
                </div>
                <div class="card">
                    <div class="card-title">価格帯別成約件数（売主）</div>
                    <div class="chart-container"><canvas id="sellerSoldPriceRangeChart"></canvas></div>
                </div>
            </div>
            <div class="charts-grid">
                <div class="card">
                    <div class="card-title">成約推移（日別）（売主）</div>
                    <div class="chart-container"><canvas id="sellerSoldTrendChart"></canvas></div>
                </div>
                <div class="card">
                    <div class="card-title">間取別成約分布（売主）</div>
                    <div class="chart-container"><canvas id="sellerSoldLayoutChart"></canvas></div>
                </div>
            </div>
            <div class="charts-grid">
                <div class="card">
                    <div class="card-title">面積帯別（坪）成約件数（売主）</div>
                    <div class="chart-container"><canvas id="sellerSoldAreaRangeChart"></canvas></div>
                </div>
                <div class="card">
                    <div class="card-title">専有面積（坪） vs 価格（売主成約物件）</div>
                    <div class="chart-container"><canvas id="sellerSoldScatterAreaChart"></canvas></div>
                </div>
            </div>
        </div>

        <!-- 詳細データセクション（コメントアウト）
        <div id="detail" class="section">
            <div class="card">
                <div class="card-title">データ定義</div>
                <div class="table-container" style="max-height:none;"><table><thead><tr><th>項目名</th><th>説明</th></tr></thead><tbody>
                    <tr><td>物件番号</td><td>物件の一意識別番号</td></tr>
                    <tr><td>物件種目</td><td>物件の種類（中古マンション等）</td></tr>
                    <tr><td>専有面積</td><td>専有部分の面積（坪）※元データは㎡を坪に変換</td></tr>
                    <tr><td>所在地</td><td>物件の所在地住所</td></tr>
                    <tr><td>取引態様</td><td>売主、一般、専任等の取引形態</td></tr>
                    <tr><td>価格</td><td>物件の販売価格（万円）</td></tr>
                    <tr><td>用途地域</td><td>都市計画法に基づく用途地域</td></tr>
                    <tr><td>坪単価</td><td>1坪あたりの価格（万円）</td></tr>
                    <tr><td>建物名</td><td>マンション等の建物名称</td></tr>
                    <tr><td>所在階</td><td>物件の所在階</td></tr>
                    <tr><td>間取</td><td>部屋の間取り</td></tr>
                    <tr><td>取引状況</td><td>公開中、申込あり、成約済み等</td></tr>
                    <tr><td>管理費</td><td>月額管理費（円）</td></tr>
                    <tr><td>沿線駅</td><td>最寄りの沿線・駅名</td></tr>
                    <tr><td>交通</td><td>駅からの距離（徒歩分数等）</td></tr>
                    <tr><td>商号</td><td>取扱不動産会社名</td></tr>
                    <tr><td>築年月</td><td>建物の竣工年月</td></tr>
                    <tr><td>電話番号</td><td>不動産会社の連絡先</td></tr>
                </tbody></table></div>
            </div>
        </div>
        -->
    </div>

    <footer>
        <p style="font-family: var(--font-display); font-size: 1.1rem; color: var(--text-primary); margin-bottom: 8px; letter-spacing: 0.15em;">REINS DASHDOARD</p>
        <p>© 2025Tokyo 6 Districts Real Estate Analytics</p>
    </footer>
    <button class="back-to-top-btn" onclick="scrollToTop()">↑</button>

    <!-- 外部JavaScript -->
    <script src="js/app.js"></script>
</body>
</html>