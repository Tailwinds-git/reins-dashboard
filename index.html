<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ±äº¬éƒ½6åŒº ä¸å‹•ç”£ç›¸å ´åˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #051F32;
            --primary-light: #0A3A5C;
            --primary-lighter: #0F4C75;
            --accent-gold: #C9A962;
            --accent-silver: #A8A8A8;
            --accent-bronze: #8B7355;
            --secondary: #2D8B7A;
            --info: #4A6FA5;
            --danger: #C75B5B;
            --bg-main: #F7F8FA;
            --bg-card: #FFFFFF;
            --border: #E8EAED;
            --text-primary: #1E2A38;
            --text-secondary: #5C6B7A;
            --shadow: 0 2px 8px rgba(5, 31, 50, 0.08);
            --shadow-lg: 0 10px 25px -5px rgba(5, 31, 50, 0.15);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Noto Sans JP', sans-serif; background: var(--bg-main); color: var(--text-primary); line-height: 1.6; }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }

        /* ãƒ˜ãƒƒãƒ€ãƒ¼ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */
        header { background: #fff; border-bottom: 1px solid var(--border); position: sticky; top: 0; z-index: 100; }
        .header-inner { max-width: 1400px; margin: 0 auto; padding: 0 20px; display: flex; align-items: center; justify-content: space-between; height: 56px; }
        .header-brand { display: flex; align-items: center; }
        .header-brand-main { font-size: 0.85rem; font-weight: 700; color: var(--text-primary); line-height: 1.3; }
        .header-brand-sub { font-size: 0.8rem; font-weight: 400; color: var(--text-secondary); }
        .header-nav { display: flex; align-items: center; gap: 32px; }
        .nav-link { font-size: 0.9rem; font-weight: 400; color: var(--text-secondary); cursor: pointer; padding: 16px 0; border-bottom: 2px solid transparent; transition: all 0.2s; }
        .nav-link:hover { color: var(--text-primary); }
        .nav-link.active { color: var(--text-primary); font-weight: 500; }
        .header-right { display: flex; align-items: center; gap: 16px; }
        .header-divider { width: 1px; height: 24px; background: var(--border); }
        .header-user { width: 32px; height: 32px; border-radius: 50%; background: var(--text-secondary); display: flex; align-items: center; justify-content: center; }
        .header-user svg { width: 18px; height: 18px; fill: #fff; }

        /* ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼ */
        .hamburger { display: none; flex-direction: column; gap: 5px; cursor: pointer; padding: 8px; }
        .hamburger span { display: block; width: 22px; height: 2px; background: var(--text-primary); transition: all 0.3s; }
        .hamburger.active span:nth-child(1) { transform: rotate(45deg) translate(5px, 5px); }
        .hamburger.active span:nth-child(2) { opacity: 0; }
        .hamburger.active span:nth-child(3) { transform: rotate(-45deg) translate(5px, -5px); }

        /* ãƒ¢ãƒã‚¤ãƒ«ãƒ¡ãƒ‹ãƒ¥ãƒ¼ */
        .mobile-menu { display: none; position: absolute; top: 56px; left: 0; right: 0; background: #fff; border-bottom: 1px solid var(--border); box-shadow: var(--shadow); }
        .mobile-menu.active { display: block; }
        .mobile-nav-link { display: block; padding: 14px 24px; color: var(--text-secondary); font-size: 0.95rem; border-bottom: 1px solid var(--border); cursor: pointer; transition: background 0.2s; }
        .mobile-nav-link:hover { background: var(--bg-main); }
        .mobile-nav-link.active { color: var(--text-primary); font-weight: 500; background: var(--bg-main); }

        .section { display: none; }
        .section.active { display: block; }

        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 25px; }
        .stat-card { background: var(--bg-card); border-radius: 12px; padding: 20px; box-shadow: var(--shadow); border-left: 4px solid var(--primary); }
        .stat-card.secondary { border-left-color: var(--secondary); }
        .stat-card.accent { border-left-color: var(--accent-gold); }
        .stat-card.info { border-left-color: var(--info); }
        .stat-label { font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 8px; }
        .stat-value { font-size: 1.8rem; font-weight: 700; }
        .stat-unit { font-size: 0.85rem; color: var(--text-secondary); font-weight: 400; }
        .stat-detail { font-size: 0.75rem; color: var(--text-secondary); margin-top: 8px; line-height: 1.8; }

        .card { background: var(--bg-card); border-radius: 12px; padding: 24px; box-shadow: var(--shadow); margin-bottom: 20px; }
        .card-title { font-size: 1rem; font-weight: 600; margin-bottom: 20px; padding-bottom: 12px; border-bottom: 2px solid var(--border); color: var(--primary); }
        .charts-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin-bottom: 20px; }
        @media (max-width: 900px) { .charts-grid { grid-template-columns: 1fr; } }
        .chart-container { position: relative; height: 350px; }

        .filter-section { background: var(--bg-card); border-radius: 12px; padding: 20px; margin-bottom: 20px; box-shadow: var(--shadow); }
        .filter-title { font-weight: 600; margin-bottom: 16px; color: var(--primary); display: flex; align-items: center; gap: 8px; }
        .filter-title-icon { font-size: 1.2rem; }
        .filter-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 12px; align-items: end; }
        .filter-group label { display: block; font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 6px; }
        .filter-group select, .filter-group input { width: 100%; padding: 10px 12px; border: 1px solid var(--border); border-radius: 8px; font-size: 0.9rem; background: white; }
        .filter-group select:focus, .filter-group input:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(5, 31, 50, 0.1); }

        /* ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ */
        .filter-header { display: flex; align-items: center; justify-content: space-between; cursor: pointer; user-select: none; }
        .filter-header .filter-title { margin-bottom: 0; }
        .filter-toggle { display: none; width: 24px; height: 24px; border-radius: 50%; background: var(--bg-main); border: 1px solid var(--border); align-items: center; justify-content: center; transition: all 0.3s; }
        .filter-toggle svg { width: 14px; height: 14px; fill: var(--text-secondary); transition: transform 0.3s; }
        .filter-section.collapsed .filter-toggle svg { transform: rotate(-90deg); }
        .filter-content { overflow: hidden; transition: max-height 0.3s ease, opacity 0.3s ease, margin 0.3s ease; }
        .filter-section.collapsed .filter-content { max-height: 0 !important; opacity: 0; margin-top: 0 !important; }
        .filter-section:not(.collapsed) .filter-content { opacity: 1; margin-top: 16px; }
        
        @media (max-width: 768px) {
            .filter-toggle { display: flex; }
            .filter-header { padding-bottom: 0; }
            .filter-section.collapsed { padding-bottom: 20px; }
        }

        .btn { padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-weight: 500; font-size: 0.9rem; transition: all 0.2s; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { background: var(--primary-light); }
        .btn-outline { background: transparent; border: 2px solid var(--primary); color: var(--primary); }
        .btn-outline:hover { background: var(--primary); color: white; }

        .table-container { overflow-x: auto; max-height: 600px; overflow-y: auto; }
        table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
        th, td { padding: 12px 14px; text-align: left; border-bottom: 1px solid var(--border); }
        th { background: var(--primary); color: white; font-weight: 600; font-size: 0.8rem; white-space: nowrap; position: sticky; top: 0; z-index: 10; }
        tr:hover { background: rgba(5, 31, 50, 0.03); }
        .rank-badge { display: inline-flex; align-items: center; justify-content: center; width: 28px; height: 28px; border-radius: 50%; font-weight: 700; font-size: 0.8rem; }
        .rank-1 { background: var(--accent-gold); color: var(--primary); }
        .rank-2 { background: var(--accent-silver); color: white; }
        .rank-3 { background: var(--accent-bronze); color: white; }
        .rank-other { background: var(--bg-main); color: var(--text-secondary); }
        .company-link { color: var(--primary); cursor: pointer; text-decoration: none; font-weight: 500; }
        .company-link:hover { text-decoration: underline; }
        .text-right { text-align: right; }
        .value-highlight { color: var(--primary); font-weight: 600; }

        .ranking-tabs { display: flex; gap: 8px; margin-bottom: 16px; }
        .ranking-tab { padding: 8px 16px; background: var(--bg-main); border: 1px solid var(--border); border-radius: 8px; cursor: pointer; font-size: 0.85rem; font-weight: 500; }
        .ranking-tab.active { background: var(--primary); color: white; border-color: var(--primary); }

        .seller-stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 16px; padding: 20px; background: linear-gradient(135deg, rgba(201, 169, 98, 0.12) 0%, rgba(201, 169, 98, 0.06) 100%); border-radius: 12px; margin-bottom: 20px; border: 1px solid rgba(201, 169, 98, 0.25); }
        .seller-stat { text-align: center; }
        .seller-stat-value { font-size: 1.5rem; font-weight: 700; }
        .seller-stat-label { font-size: 0.75rem; color: var(--text-secondary); }

        .district-table th { background: var(--bg-main); color: var(--text-secondary); font-size: 0.75rem; }

        .pagination { display: flex; justify-content: center; align-items: center; gap: 8px; margin-top: 20px; flex-wrap: wrap; }
        .pagination button { padding: 8px 14px; border: 1px solid var(--border); background: white; border-radius: 6px; cursor: pointer; font-size: 0.85rem; }
        .pagination button:hover:not(:disabled) { border-color: var(--primary); color: var(--primary); }
        .pagination button.active { background: var(--primary); color: white; border-color: var(--primary); }
        .pagination button:disabled { opacity: 0.5; cursor: not-allowed; }

        .results-count { font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 16px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 12px; }
        .results-count strong { color: var(--primary); }
        .export-btn { display: inline-flex; align-items: center; gap: 6px; padding: 8px 16px; background: var(--secondary); color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 0.85rem; font-weight: 500; }
        .export-btn:hover { background: #246b5e; }
        .sort-select { padding: 8px 12px; border: 1px solid var(--border); border-radius: 6px; font-size: 0.85rem; background: white; }

        .status-badge { display: inline-block; padding: 4px 10px; border-radius: 12px; font-size: 0.75rem; font-weight: 500; }
        .status-active { background: rgba(45, 139, 122, 0.15); color: var(--secondary); }
        .status-pending { background: rgba(201, 169, 98, 0.2); color: #8B7355; }
        .status-sold { background: rgba(199, 91, 91, 0.15); color: var(--danger); }

        .time-filter-buttons { display: flex; gap: 8px; margin-bottom: 20px; }
        .time-btn { padding: 10px 20px; border: 2px solid var(--border); background: white; border-radius: 8px; cursor: pointer; font-size: 0.9rem; font-weight: 500; }
        .time-btn.active { border-color: var(--primary); background: var(--primary); color: white; }
        .time-btn:hover:not(.active) { border-color: var(--primary); color: var(--primary); }

        .update-badge { display: inline-flex; align-items: center; gap: 4px; padding: 2px 8px; border-radius: 4px; font-size: 0.7rem; font-weight: 500; }
        .update-price-down { background: rgba(45, 139, 122, 0.1); color: var(--secondary); }
        .update-price-up { background: rgba(199, 91, 91, 0.1); color: var(--danger); }
        .update-status { background: rgba(74, 111, 165, 0.1); color: var(--info); }

        footer { text-align: center; padding: 24px; color: var(--text-secondary); font-size: 0.8rem; border-top: 1px solid var(--border); margin-top: 40px; }
        .back-to-top-btn { display: none; position: fixed; bottom: 30px; right: 30px; padding: 12px 16px; background: var(--primary); color: white; border: none; border-radius: 8px; cursor: pointer; box-shadow: var(--shadow-lg); z-index: 1000; }
        .back-to-top-btn:hover { background: var(--primary-light); }

        /* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é€šçŸ¥ãƒãƒƒã‚¸ */
        .filter-active-badge { display: inline-flex; align-items: center; gap: 6px; padding: 6px 12px; background: rgba(201, 169, 98, 0.15); border: 1px solid var(--accent-gold); border-radius: 20px; font-size: 0.8rem; color: var(--accent-bronze); margin-bottom: 16px; }
        .filter-active-badge .count { font-weight: 700; color: var(--primary); }

        /* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° */
        .loading-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(255,255,255,0.9); display: flex; align-items: center; justify-content: center; z-index: 9999; }
        .loading-spinner { width: 40px; height: 40px; border: 3px solid var(--border); border-top-color: var(--primary); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
        @media (max-width: 1024px) {
            .header-nav { display: none; }
            .hamburger { display: flex; }
        }

        @media (max-width: 768px) {
            .container { padding: 12px; }
            .header-brand-sub { display: none; }
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            .filter-grid { grid-template-columns: 1fr; }
            .chart-container { height: 280px; }
            th, td { padding: 8px 10px; font-size: 0.8rem; }
        }

        @media (max-width: 480px) {
            .stats-grid { grid-template-columns: 1fr; }
        }

        /* æœŸé–“è¡¨ç¤ºåˆ‡æ›¿ */
        .period-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            align-items: flex-end;
        }
        .period-unit-selector label,
        .period-value-selector label {
            display: block;
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }
        .period-unit-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        .period-unit-btn {
            padding: 10px 18px;
            border: 2px solid var(--border);
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.2s;
        }
        .period-unit-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
        }
        .period-unit-btn.active {
            border-color: var(--primary);
            background: var(--primary);
            color: white;
        }
        .period-value-selector select,
        .period-value-selector input[type="date"] {
            padding: 10px 14px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 0.9rem;
            background: white;
            min-width: 200px;
        }
        .period-value-selector select:focus,
        .period-value-selector input[type="date"]:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(5, 31, 50, 0.1);
        }
        .period-display {
            padding: 10px 16px;
            background: rgba(201, 169, 98, 0.12);
            border: 1px solid rgba(201, 169, 98, 0.3);
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .period-display-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        .period-display-value {
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--primary);
        }
        @media (max-width: 768px) {
            .period-selector {
                flex-direction: column;
                align-items: stretch;
            }
            .period-unit-buttons {
                flex-wrap: wrap;
            }
            .period-unit-btn {
                flex: 1;
                min-width: 70px;
                padding: 8px 12px;
                font-size: 0.85rem;
            }
        }
    </style>
</head>
<body>
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <header>
        <div class="header-inner">
            <div class="header-brand">
                <span class="header-brand-main">ãƒ¬ã‚¤ãƒ³ã‚º<br>ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</span>
            </div>
            <nav class="header-nav">
                <span class="nav-link active" data-section="overview">åœ¨åº«çµ±è¨ˆ</span>
                <span class="nav-link" data-section="seller">å•†å·åˆ¥ãƒ©ãƒ³ã‚­ãƒ³ã‚°</span>
                <span class="nav-link" data-section="propertyList">åœ¨åº«ç‰©ä»¶ãƒªã‚¹ãƒˆ</span>
                <span class="nav-link" data-section="soldList">æˆç´„çµ±è¨ˆ</span>
                <span class="nav-link" data-section="updateList">æˆç´„æ¸ˆã¿ç‰©ä»¶ãƒ»æ›´æ–°ç‰©ä»¶ãƒªã‚¹ãƒˆ</span>
            </nav>
            <div class="header-right">
                <div class="hamburger" id="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <div class="header-divider"></div>
                <div class="header-user">
                    <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                </div>
            </div>
        </div>
        <div class="mobile-menu" id="mobileMenu">
            <div class="mobile-nav-link active" data-section="overview">åœ¨åº«çµ±è¨ˆ</div>
            <div class="mobile-nav-link" data-section="seller">å•†å·åˆ¥ãƒ©ãƒ³ã‚­ãƒ³ã‚°</div>
            <div class="mobile-nav-link" data-section="propertyList">åœ¨åº«ç‰©ä»¶ãƒªã‚¹ãƒˆ</div>
            <div class="mobile-nav-link" data-section="soldList">æˆç´„çµ±è¨ˆ</div>
            <div class="mobile-nav-link" data-section="updateList">æˆç´„æ¸ˆã¿ç‰©ä»¶ãƒ»æ›´æ–°ç‰©ä»¶ãƒªã‚¹ãƒˆ</div>
        </div>
    </header>

    <div class="container">
        <!-- åœ¨åº«çµ±è¨ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div id="overview" class="section active">
            <!-- åœ¨åº«çµ±è¨ˆç”¨ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
            <div class="filter-section" id="stats-filter-section">
                <div class="filter-header" onclick="toggleFilter('stats-filter-section')">
                    <div class="filter-title">çµ±è¨ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</div>
                    <div class="filter-toggle">
                        <svg viewBox="0 0 24 24"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
                    </div>
                </div>
                <div class="filter-content">
                    <div class="filter-grid">
                        <div class="filter-group">
                            <label>å–å¼•æ…‹æ§˜</label>
                            <select id="stats-filter-torihiki">
                                <option value="">ã™ã¹ã¦</option>
                                <option value="å£²ä¸»">å£²ä¸»</option>
                                <option value="å°‚ä»»">å°‚ä»»</option>
                                <option value="å°‚å±">å°‚å±</option>
                                <option value="ä¸€èˆ¬">ä¸€èˆ¬</option>
                                <option value="ä»£ç†">ä»£ç†</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>åŒº</label>
                            <select id="stats-filter-district">
                                <option value="">å…¨åŒº</option>
                                <option value="æ¸¯åŒº">æ¸¯åŒº</option>
                                <option value="ä¸­å¤®åŒº">ä¸­å¤®åŒº</option>
                                <option value="åƒä»£ç”°åŒº">åƒä»£ç”°åŒº</option>
                                <option value="æ¸‹è°·åŒº">æ¸‹è°·åŒº</option>
                                <option value="æ–°å®¿åŒº">æ–°å®¿åŒº</option>
                                <option value="æ–‡äº¬åŒº">æ–‡äº¬åŒº</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>é–“å–</label>
                            <select id="stats-filter-layout">
                                <option value="">ã™ã¹ã¦</option>
                                <option value="1R">1R</option>
                                <option value="1K">1K</option>
                                <option value="1DK">1DK</option>
                                <option value="1LDK">1LDK</option>
                                <option value="2K">2K</option>
                                <option value="2DK">2DK</option>
                                <option value="2LDK">2LDK</option>
                                <option value="3K">3K</option>
                                <option value="3DK">3DK</option>
                                <option value="3LDK">3LDK</option>
                                <option value="4LDK">4LDK</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>ä¾¡æ ¼ï¼ˆä¸‡å††ï¼‰</label>
                            <select id="stats-filter-price">
                                <option value="">ã™ã¹ã¦</option>
                                <option value="0-5000">ï½5,000ä¸‡å††</option>
                                <option value="5000-10000">5,000ï½10,000ä¸‡å††</option>
                                <option value="10000-15000">10,000ï½15,000ä¸‡å††</option>
                                <option value="15000-20000">15,000ï½20,000ä¸‡å††</option>
                                <option value="20000-25000">20,000ï½25,000ä¸‡å††</option>
                                <option value="25000-30000">25,000ï½30,000ä¸‡å††</option>
                                <option value="30000-">30,000ä¸‡å††ï½</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>å°‚æœ‰é¢ç©ï¼ˆåªï¼‰</label>
                            <select id="stats-filter-area">
                                <option value="">ã™ã¹ã¦</option>
                                <option value="0-10">ï½10åª</option>
                                <option value="10-15">10ï½15åª</option>
                                <option value="15-20">15ï½20åª</option>
                                <option value="20-25">20ï½25åª</option>
                                <option value="25-30">25ï½30åª</option>
                                <option value="30-35">30ï½35åª</option>
                                <option value="35-40">35ï½40åª</option>
                                <option value="40-">40åªï½</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>ç¯‰å¹´æ•°</label>
                            <select id="stats-filter-age">
                                <option value="">ã™ã¹ã¦</option>
                                <option value="0-5">ï½5å¹´</option>
                                <option value="5-10">5ï½10å¹´</option>
                                <option value="10-15">10ï½15å¹´</option>
                                <option value="15-20">15ï½20å¹´</option>
                                <option value="20-25">20ï½25å¹´</option>
                                <option value="25-30">25ï½30å¹´</option>
                                <option value="30-">30å¹´ï½</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <button class="btn btn-primary" onclick="applyStatsFilter()">é©ç”¨</button>
                        </div>
                        <div class="filter-group">
                            <button class="btn btn-outline" onclick="resetStatsFilter()">ãƒªã‚»ãƒƒãƒˆ</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨çŠ¶æ…‹è¡¨ç¤º -->
            <div id="stats-filter-badge" class="filter-active-badge" style="display:none;">
                ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨ä¸­: <span class="count" id="stats-filtered-count">0</span>ä»¶ / å…¨<span id="stats-total-count">0</span>ä»¶
            </div>

            <div class="card">
                <div class="card-title">çµ±è¨ˆã‚µãƒãƒªãƒ¼</div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">ä¾¡æ ¼ï¼ˆä¸‡å††ï¼‰å¹³å‡</div>
                        <div class="stat-value" id="stat-price-avg">-</div>
                        <div class="stat-detail" id="stat-price-detail">-</div>
                    </div>
                    <div class="stat-card secondary">
                        <div class="stat-label">å°‚æœ‰é¢ç©ï¼ˆåªï¼‰å¹³å‡</div>
                        <div class="stat-value" id="stat-area-avg">-</div>
                        <div class="stat-detail" id="stat-area-detail">-</div>
                    </div>
                    <div class="stat-card accent">
                        <div class="stat-label">åªå˜ä¾¡ï¼ˆä¸‡å††ï¼‰å¹³å‡</div>
                        <div class="stat-value" id="stat-sqm-avg">-</div>
                        <div class="stat-detail" id="stat-sqm-detail">-</div>
                    </div>
                    <div class="stat-card info">
                        <div class="stat-label">ç‰©ä»¶æ•°</div>
                        <div class="stat-value"><span id="stat-count">-</span><span class="stat-unit">ä»¶</span></div>
                    </div>
                </div>

                <div class="card-title" style="margin-top:20px;">åŒºåˆ¥çµ±è¨ˆ</div>
                <div class="table-container" style="max-height:none;">
                    <table class="district-table">
                        <thead><tr><th>åŒº</th><th class="text-right">ç‰©ä»¶æ•°</th><th class="text-right">å¹³å‡ä¾¡æ ¼ï¼ˆä¸‡å††ï¼‰</th><th class="text-right">ä¸­å¤®å€¤ä¾¡æ ¼ï¼ˆä¸‡å††ï¼‰</th><th class="text-right">å¹³å‡é¢ç©ï¼ˆåªï¼‰</th></tr></thead>
                        <tbody id="district-stats-body"></tbody>
                    </table>
                </div>
            </div>

            <div class="charts-grid">
                <div class="card">
                    <div class="card-title">ä¾¡æ ¼åˆ†å¸ƒ</div>
                    <div class="chart-container"><canvas id="priceDistChart"></canvas></div>
                </div>
                <div class="card">
                    <div class="card-title">åŒºåˆ¥ç‰©ä»¶æ•°</div>
                    <div class="chart-container"><canvas id="districtChart"></canvas></div>
                </div>
            </div>
            <div class="charts-grid">
                <div class="card">
                    <div class="card-title">å°‚æœ‰é¢ç©ï¼ˆåªï¼‰ vs ä¾¡æ ¼ï¼ˆå…¨ä»¶ï¼‰</div>
                    <div class="chart-container"><canvas id="scatterAreaChart"></canvas></div>
                </div>
                <div class="card">
                    <div class="card-title">ç¯‰å¹´æ•° vs ä¾¡æ ¼ï¼ˆå…¨ä»¶ï¼‰</div>
                    <div class="chart-container"><canvas id="scatterAgeChart"></canvas></div>
                </div>
            </div>
        </div>

        <!-- å£²ä¸»ç‰©ä»¶ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div id="seller" class="section">
            <!-- å•†å·åˆ¥ãƒ©ãƒ³ã‚­ãƒ³ã‚°ç”¨ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
            <div class="filter-section" id="seller-filter-section">
                <div class="filter-header" onclick="toggleFilter('seller-filter-section')">
                    <div class="filter-title">ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</div>
                    <div class="filter-toggle">
                        <svg viewBox="0 0 24 24"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
                    </div>
                </div>
                <div class="filter-content">
                    <div class="filter-grid">
                        <div class="filter-group">
                            <label>åŒº</label>
                            <select id="seller-filter-district">
                                <option value="">å…¨åŒº</option>
                                <option value="æ¸¯åŒº">æ¸¯åŒº</option>
                                <option value="ä¸­å¤®åŒº">ä¸­å¤®åŒº</option>
                                <option value="åƒä»£ç”°åŒº">åƒä»£ç”°åŒº</option>
                                <option value="æ¸‹è°·åŒº">æ¸‹è°·åŒº</option>
                                <option value="æ–°å®¿åŒº">æ–°å®¿åŒº</option>
                                <option value="æ–‡äº¬åŒº">æ–‡äº¬åŒº</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>å–å¼•æ…‹æ§˜</label>
                            <select id="seller-filter-torihiki">
                                <option value="">ã™ã¹ã¦</option>
                                <option value="å£²ä¸»">å£²ä¸»</option>
                                <option value="å°‚ä»»">å°‚ä»»</option>
                                <option value="å°‚å±">å°‚å±</option>
                                <option value="ä¸€èˆ¬">ä¸€èˆ¬</option>
                                <option value="ä»£ç†">ä»£ç†</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <button class="btn btn-primary" onclick="applySellerFilter()">é©ç”¨</button>
                        </div>
                        <div class="filter-group">
                            <button class="btn btn-outline" onclick="resetSellerFilter()">ãƒªã‚»ãƒƒãƒˆ</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨çŠ¶æ…‹è¡¨ç¤º -->
            <div id="seller-filter-badge" class="filter-active-badge" style="display:none;">
                ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨ä¸­: <span class="count" id="seller-filtered-count">0</span>ä»¶ / å…¨<span id="seller-total-count">0</span>ä»¶
            </div>

            <div class="seller-stats">
                <div class="seller-stat"><div class="seller-stat-value" id="seller-company-count">-<span class="stat-unit">ç¤¾</span></div><div class="seller-stat-label">å¯¾è±¡ç‰©ä»¶ã‚’æ‰±ã†å•†å·æ•°</div></div>
                <div class="seller-stat"><div class="seller-stat-value" id="seller-total-amount">-<span class="stat-unit">å„„å††</span></div><div class="seller-stat-label">å¯¾è±¡ç‰©ä»¶ç·é¡</div></div>
                <div class="seller-stat"><div class="seller-stat-value" id="seller-property-count">-<span class="stat-unit">ä»¶</span></div><div class="seller-stat-label">å¯¾è±¡ç‰©ä»¶æ•°</div></div>
            </div>
            <div class="charts-grid">
                <div class="card"><div class="card-title" id="seller-total-chart-title">åœ¨åº«ç‰©ä»¶ç·é¡ TOP15</div><div class="chart-container"><canvas id="sellerTotalChart"></canvas></div></div>
                <div class="card"><div class="card-title" id="seller-count-chart-title">åœ¨åº«ç‰©ä»¶æ•° TOP15</div><div class="chart-container"><canvas id="sellerCountChart"></canvas></div></div>
            </div>
            <div class="card">
                <div class="card-title" id="seller-ranking-title">åœ¨åº«ç‰©ä»¶ å•†å·åˆ¥è©³ç´°ãƒ©ãƒ³ã‚­ãƒ³ã‚°</div>
                <div class="ranking-tabs">
                    <button class="ranking-tab active" data-sort="total">åœ¨åº«ç‰©ä»¶ç·é¡(å„„å††) â–¼</button>
                    <button class="ranking-tab" data-sort="count">åœ¨åº«ç‰©ä»¶æ•°</button>
                    <button class="ranking-tab" data-sort="avg">å¹³å‡å˜ä¾¡(ä¸‡å††)</button>
                </div>
                <div class="table-container"><table><thead><tr><th>é †ä½</th><th>å•†å·</th><th class="text-right">ç·é¡(å„„å††)</th><th class="text-right">ä»¶æ•°</th><th class="text-right">å¹³å‡(ä¸‡å††)</th></tr></thead><tbody id="sellerRankingBody"></tbody></table></div>
            </div>
        </div>

        <!-- æ²è¼‰ç‰©ä»¶ãƒªã‚¹ãƒˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div id="propertyList" class="section">
            <div class="filter-section" id="pl-filter-section">
                <div class="filter-header" onclick="toggleFilter('pl-filter-section')">
                    <div class="filter-title">ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</div>
                    <div class="filter-toggle">
                        <svg viewBox="0 0 24 24"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
                    </div>
                </div>
                <div class="filter-content">
                    <div class="filter-grid">
                        <div class="filter-group"><label>åŒº</label><select id="pl-filter-district"><option value="">å…¨åŒº</option><option value="æ¸¯åŒº">æ¸¯åŒº</option><option value="ä¸­å¤®åŒº">ä¸­å¤®åŒº</option><option value="åƒä»£ç”°åŒº">åƒä»£ç”°åŒº</option><option value="æ¸‹è°·åŒº">æ¸‹è°·åŒº</option><option value="æ–°å®¿åŒº">æ–°å®¿åŒº</option><option value="æ–‡äº¬åŒº">æ–‡äº¬åŒº</option></select></div>
                        <div class="filter-group"><label>å»ºç‰©å</label><input type="text" id="pl-filter-building" placeholder="éƒ¨åˆ†ä¸€è‡´"></div>
                        <div class="filter-group"><label>å•†å·</label><input type="text" id="pl-filter-company" placeholder="éƒ¨åˆ†ä¸€è‡´"></div>
                        <div class="filter-group">
                            <label>é–“å–</label>
                            <select id="pl-filter-layout">
                                <option value="">ã™ã¹ã¦</option>
                                <option value="1R">1R</option>
                                <option value="1K">1K</option>
                                <option value="1DK">1DK</option>
                                <option value="1LDK">1LDK</option>
                                <option value="2K">2K</option>
                                <option value="2DK">2DK</option>
                                <option value="2LDK">2LDK</option>
                                <option value="3K">3K</option>
                                <option value="3DK">3DK</option>
                                <option value="3LDK">3LDK</option>
                                <option value="4LDK">4LDK</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>ä¾¡æ ¼ï¼ˆä¸‡å††ï¼‰</label>
                            <select id="pl-filter-price">
                                <option value="">ã™ã¹ã¦</option>
                                <option value="0-5000">ï½5,000ä¸‡å††</option>
                                <option value="5000-10000">5,000ï½10,000ä¸‡å††</option>
                                <option value="10000-15000">10,000ï½15,000ä¸‡å††</option>
                                <option value="15000-20000">15,000ï½20,000ä¸‡å††</option>
                                <option value="20000-25000">20,000ï½25,000ä¸‡å††</option>
                                <option value="25000-30000">25,000ï½30,000ä¸‡å††</option>
                                <option value="30000-">30,000ä¸‡å††ï½</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>å°‚æœ‰é¢ç©ï¼ˆåªï¼‰</label>
                            <select id="pl-filter-area">
                                <option value="">ã™ã¹ã¦</option>
                                <option value="0-10">ï½10åª</option>
                                <option value="10-15">10ï½15åª</option>
                                <option value="15-20">15ï½20åª</option>
                                <option value="20-25">20ï½25åª</option>
                                <option value="25-30">25ï½30åª</option>
                                <option value="30-35">30ï½35åª</option>
                                <option value="35-40">35ï½40åª</option>
                                <option value="40-">40åªï½</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>ç¯‰å¹´æ•°</label>
                            <select id="pl-filter-age">
                                <option value="">ã™ã¹ã¦</option>
                                <option value="0-5">ï½5å¹´</option>
                                <option value="5-10">5ï½10å¹´</option>
                                <option value="10-15">10ï½15å¹´</option>
                                <option value="15-20">15ï½20å¹´</option>
                                <option value="20-25">20ï½25å¹´</option>
                                <option value="25-30">25ï½30å¹´</option>
                                <option value="30-">30å¹´ï½</option>
                            </select>
                        </div>
                        <div class="filter-group"><button class="btn btn-primary" onclick="applyPropertyFilter()">é©ç”¨</button></div>
                        <div class="filter-group"><button class="btn btn-outline" onclick="resetPropertyFilter()">ãƒªã‚»ãƒƒãƒˆ</button></div>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="results-count">
                    <div>æ¤œç´¢çµæœ: <strong id="pl-result-count">0</strong>ä»¶ <span id="pl-filter-notice" style="color:var(--accent-gold);margin-left:12px;"></span></div>
                    <div style="display:flex;gap:12px;align-items:center;">
                        <select class="sort-select" id="pl-sort-select" onchange="sortPropertyList()">
                            <option value="id-asc">ç‰©ä»¶ç•ªå· æ˜‡é †</option>
                            <option value="id-desc">ç‰©ä»¶ç•ªå· é™é †</option>
                            <option value="price-asc">ä¾¡æ ¼ å®‰ã„é †</option>
                            <option value="price-desc">ä¾¡æ ¼ é«˜ã„é †</option>
                            <option value="area-asc">é¢ç© å°ã•ã„é †</option>
                            <option value="area-desc">é¢ç© å¤§ãã„é †</option>
                        </select>
                        <button class="export-btn" onclick="exportPropertyCSV()">ğŸ“¥ CSVå‡ºåŠ›</button>
                    </div>
                </div>
                <div class="table-container"><table><thead><tr><th>ç‰©ä»¶ç•ªå·</th><th>åŒº</th><th>å»ºç‰©å</th><th>éš</th><th>é–“å–</th><th class="text-right">ä¾¡æ ¼</th><th class="text-right">é¢ç©</th><th class="text-right">ç¯‰å¹´</th><th>çŠ¶æ³</th><th>å•†å·</th></tr></thead><tbody id="propertyListBody"></tbody></table></div>
                <div class="pagination" id="pl-pagination"></div>
            </div>
        </div>

        <!-- æˆç´„æ¸ˆã¿ç‰©ä»¶ãƒ»æ›´æ–°ç‰©ä»¶ãƒªã‚¹ãƒˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div id="updateList" class="section">
            <!-- æˆç´„æ¸ˆã¿ç‰©ä»¶ãƒªã‚¹ãƒˆ -->
            <div class="card">
                <div class="card-title">æˆç´„æ¸ˆã¿ç‰©ä»¶ãƒªã‚¹ãƒˆ - æ²è¼‰çµ‚äº†ï¼ˆæˆç´„æ¸ˆã¿ï¼‰ã¨ãªã£ãŸç‰©ä»¶</div>
                <p style="color:var(--text-secondary);font-size:0.85rem;margin-bottom:20px;">â€»differences_master.csvã®å·®åˆ†ç¨®åˆ¥ã€Œå‰Šé™¤ã€ã‚’æˆç´„æ¸ˆã¿ã¨ã—ã¦è¡¨ç¤ºã—ã¦ã„ã¾ã™</p>
                
                <!-- æˆç´„æ¸ˆã¿ç‰©ä»¶ãƒªã‚¹ãƒˆç”¨ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
                <div class="filter-section" id="sold-list-filter-section" style="margin-bottom:16px;box-shadow:none;padding:16px;background:var(--bg-main);">
                    <div class="filter-header" onclick="toggleFilter('sold-list-filter-section')">
                        <div class="filter-title" style="font-size:0.9rem;margin-bottom:0;">ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</div>
                        <div class="filter-toggle">
                            <svg viewBox="0 0 24 24"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
                        </div>
                    </div>
                    <div class="filter-content">
                        <div class="filter-grid">
                            <div class="filter-group"><label>åŒº</label><select id="sold-list-filter-district"><option value="">å…¨åŒº</option><option value="æ¸¯åŒº">æ¸¯åŒº</option><option value="ä¸­å¤®åŒº">ä¸­å¤®åŒº</option><option value="åƒä»£ç”°åŒº">åƒä»£ç”°åŒº</option><option value="æ¸‹è°·åŒº">æ¸‹è°·åŒº</option><option value="æ–°å®¿åŒº">æ–°å®¿åŒº</option><option value="æ–‡äº¬åŒº">æ–‡äº¬åŒº</option></select></div>
                            <div class="filter-group"><label>å»ºç‰©å</label><input type="text" id="sold-list-filter-building" placeholder="éƒ¨åˆ†ä¸€è‡´"></div>
                            <div class="filter-group"><label>å•†å·</label><input type="text" id="sold-list-filter-company" placeholder="éƒ¨åˆ†ä¸€è‡´"></div>
                            <div class="filter-group">
                                <label>é–“å–</label>
                                <select id="sold-list-filter-layout">
                                    <option value="">ã™ã¹ã¦</option>
                                    <option value="1R">1R</option>
                                    <option value="1K">1K</option>
                                    <option value="1DK">1DK</option>
                                    <option value="1LDK">1LDK</option>
                                    <option value="2K">2K</option>
                                    <option value="2DK">2DK</option>
                                    <option value="2LDK">2LDK</option>
                                    <option value="3K">3K</option>
                                    <option value="3DK">3DK</option>
                                    <option value="3LDK">3LDK</option>
                                    <option value="4LDK">4LDK</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label>ä¾¡æ ¼ï¼ˆä¸‡å††ï¼‰</label>
                                <select id="sold-list-filter-price">
                                    <option value="">ã™ã¹ã¦</option>
                                    <option value="0-5000">ï½5,000ä¸‡å††</option>
                                    <option value="5000-10000">5,000ï½10,000ä¸‡å††</option>
                                    <option value="10000-15000">10,000ï½15,000ä¸‡å††</option>
                                    <option value="15000-20000">15,000ï½20,000ä¸‡å††</option>
                                    <option value="20000-25000">20,000ï½25,000ä¸‡å††</option>
                                    <option value="25000-30000">25,000ï½30,000ä¸‡å††</option>
                                    <option value="30000-">30,000ä¸‡å††ï½</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label>å°‚æœ‰é¢ç©ï¼ˆåªï¼‰</label>
                                <select id="sold-list-filter-area">
                                    <option value="">ã™ã¹ã¦</option>
                                    <option value="0-10">ï½10åª</option>
                                    <option value="10-15">10ï½15åª</option>
                                    <option value="15-20">15ï½20åª</option>
                                    <option value="20-25">20ï½25åª</option>
                                    <option value="25-30">25ï½30åª</option>
                                    <option value="30-35">30ï½35åª</option>
                                    <option value="35-40">35ï½40åª</option>
                                    <option value="40-">40åªï½</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label>ç¯‰å¹´æ•°</label>
                                <select id="sold-list-filter-age">
                                    <option value="">ã™ã¹ã¦</option>
                                    <option value="0-5">ï½5å¹´</option>
                                    <option value="5-10">5ï½10å¹´</option>
                                    <option value="10-15">10ï½15å¹´</option>
                                    <option value="15-20">15ï½20å¹´</option>
                                    <option value="20-25">20ï½25å¹´</option>
                                    <option value="25-30">25ï½30å¹´</option>
                                    <option value="30-">30å¹´ï½</option>
                                </select>
                            </div>
                            <div class="filter-group"><button class="btn btn-primary" onclick="applySoldListFilter()">é©ç”¨</button></div>
                            <div class="filter-group"><button class="btn btn-outline" onclick="resetSoldListFilter()">ãƒªã‚»ãƒƒãƒˆ</button></div>
                        </div>
                    </div>
                </div>
                
                <div class="results-count">
                    <div>æˆç´„æ¸ˆã¿ç‰©ä»¶æ•°: <strong id="sold-result-count">0</strong>ä»¶ <span id="sold-list-filter-notice" style="color:var(--accent-gold);margin-left:12px;"></span></div>
                    <div style="display:flex;gap:12px;align-items:center;">
                        <select class="sort-select" id="sold-sort-select" onchange="sortSoldList()">
                            <option value="soldDate-desc">æˆç´„æ—¥ æ–°ã—ã„é †</option>
                            <option value="soldDate-asc">æˆç´„æ—¥ å¤ã„é †</option>
                            <option value="id-desc">ç‰©ä»¶ç•ªå· é™é †</option>
                            <option value="id-asc">ç‰©ä»¶ç•ªå· æ˜‡é †</option>
                            <option value="price-desc">ä¾¡æ ¼ é«˜ã„é †</option>
                            <option value="price-asc">ä¾¡æ ¼ å®‰ã„é †</option>
                        </select>
                        <button class="export-btn" onclick="exportSoldCSV()">ğŸ“¥ CSVå‡ºåŠ›</button>
                    </div>
                </div>
                <div class="table-container"><table><thead><tr><th>æˆç´„æ—¥</th><th>ç‰©ä»¶ç•ªå·</th><th>åŒº</th><th>å»ºç‰©å</th><th>éš</th><th>é–“å–</th><th class="text-right">ä¾¡æ ¼</th><th class="text-right">é¢ç©</th><th class="text-right">ç¯‰å¹´</th><th>å•†å·</th></tr></thead><tbody id="soldListBody"></tbody></table></div>
                <div class="pagination" id="sold-pagination"></div>
            </div>

            <!-- æ›´æ–°ç‰©ä»¶ãƒªã‚¹ãƒˆ -->
            <div class="card">
                <div class="card-title">æ›´æ–°ç‰©ä»¶ãƒªã‚¹ãƒˆ - æƒ…å ±æ›´æ–°ãŒã‚ã£ãŸç‰©ä»¶</div>
                <div class="time-filter-buttons">
                    <button class="time-btn active" data-period="yesterday">æ˜¨æ—¥ã‹ã‚‰</button>
                    <button class="time-btn" data-period="week">1é€±é–“å‰ã‹ã‚‰</button>
                    <button class="time-btn" data-period="month">1ã‹æœˆå‰ã‹ã‚‰</button>
                </div>
                <p style="color:var(--text-secondary);font-size:0.85rem;margin-bottom:20px;">â€»ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿: å®Ÿéš›ã®ã‚·ã‚¹ãƒ†ãƒ ã§ã¯éå»ãƒ‡ãƒ¼ã‚¿ã¨ã®å·®åˆ†æ¯”è¼ƒã«ã‚ˆã‚Šæ›´æ–°ã‚’æ¤œå‡ºã—ã¾ã™</p>
                <div class="results-count"><div>æ›´æ–°ç‰©ä»¶æ•°: <strong id="ul-result-count">0</strong>ä»¶</div></div>
                <div class="table-container"><table><thead><tr><th>ç‰©ä»¶ç•ªå·</th><th>å»ºç‰©å</th><th>æ›´æ–°å†…å®¹</th><th>å¤‰æ›´å‰</th><th>å¤‰æ›´å¾Œ</th><th>å‚™è€ƒ</th></tr></thead><tbody id="updateListBody"></tbody></table></div>
            </div>
        </div>

        <!-- æˆç´„æ¸ˆã¿ç‰©ä»¶ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div id="soldList" class="section">
            <!-- æœŸé–“è¡¨ç¤ºåˆ‡æ›¿ -->
            <div class="filter-section" style="margin-bottom:16px;">
                <div class="filter-title">æœŸé–“è¡¨ç¤ºåˆ‡æ›¿</div>
                <div class="period-selector">
                    <div class="period-unit-selector">
                        <label>è¡¨ç¤ºå˜ä½</label>
                        <div class="period-unit-buttons">
                            <button class="period-unit-btn active" data-unit="all" onclick="changePeriodUnit('all')">å…¨æœŸé–“</button>
                            <button class="period-unit-btn" data-unit="day" onclick="changePeriodUnit('day')">æ—¥å˜ä½</button>
                            <button class="period-unit-btn" data-unit="week" onclick="changePeriodUnit('week')">é€±å˜ä½</button>
                            <button class="period-unit-btn" data-unit="month" onclick="changePeriodUnit('month')">æœˆå˜ä½</button>
                        </div>
                    </div>
                    <div class="period-value-selector" id="period-value-container" style="display:none;">
                        <label id="period-value-label">æœŸé–“é¸æŠ</label>
                        <div id="period-value-input"></div>
                    </div>
                    <div class="period-display" id="period-display">
                        <span class="period-display-label">è¡¨ç¤ºæœŸé–“:</span>
                        <span class="period-display-value" id="period-display-value">å…¨æœŸé–“</span>
                    </div>
                </div>
            </div>

            <!-- æˆç´„æ¸ˆã¿ç‰©ä»¶ç”¨ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
            <div class="filter-section" id="sold-filter-section">
                <div class="filter-header" onclick="toggleFilter('sold-filter-section')">
                    <div class="filter-title">æ¤œç´¢æ¡ä»¶</div>
                    <div class="filter-toggle">
                        <svg viewBox="0 0 24 24"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
                    </div>
                </div>
                <div class="filter-content">
                    <div class="filter-grid">
                        <div class="filter-group">
                            <label>å–å¼•æ…‹æ§˜</label>
                            <select id="sold-filter-torihiki">
                                <option value="">ã™ã¹ã¦</option>
                                <option value="å£²ä¸»">å£²ä¸»</option>
                                <option value="å°‚ä»»">å°‚ä»»</option>
                                <option value="å°‚å±">å°‚å±</option>
                                <option value="ä¸€èˆ¬">ä¸€èˆ¬</option>
                                <option value="ä»£ç†">ä»£ç†</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>åŒº</label>
                            <select id="sold-filter-district">
                                <option value="">å…¨åŒº</option>
                                <option value="æ¸¯åŒº">æ¸¯åŒº</option>
                                <option value="ä¸­å¤®åŒº">ä¸­å¤®åŒº</option>
                                <option value="åƒä»£ç”°åŒº">åƒä»£ç”°åŒº</option>
                                <option value="æ¸‹è°·åŒº">æ¸‹è°·åŒº</option>
                                <option value="æ–°å®¿åŒº">æ–°å®¿åŒº</option>
                                <option value="æ–‡äº¬åŒº">æ–‡äº¬åŒº</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>å»ºç‰©å</label>
                            <input type="text" id="sold-filter-building" placeholder="éƒ¨åˆ†ä¸€è‡´">
                        </div>
                        <div class="filter-group">
                            <label>é–“å–</label>
                            <select id="sold-filter-layout">
                                <option value="">ã™ã¹ã¦</option>
                                <option value="1R">1R</option>
                                <option value="1K">1K</option>
                                <option value="1DK">1DK</option>
                                <option value="1LDK">1LDK</option>
                                <option value="2K">2K</option>
                                <option value="2DK">2DK</option>
                                <option value="2LDK">2LDK</option>
                                <option value="3K">3K</option>
                                <option value="3DK">3DK</option>
                                <option value="3LDK">3LDK</option>
                                <option value="4LDK">4LDK</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>ä¾¡æ ¼ï¼ˆä¸‡å††ï¼‰</label>
                            <select id="sold-filter-price">
                                <option value="">ã™ã¹ã¦</option>
                                <option value="0-5000">ï½5,000ä¸‡å††</option>
                                <option value="5000-10000">5,000ï½10,000ä¸‡å††</option>
                                <option value="10000-15000">10,000ï½15,000ä¸‡å††</option>
                                <option value="15000-20000">15,000ï½20,000ä¸‡å††</option>
                                <option value="20000-25000">20,000ï½25,000ä¸‡å††</option>
                                <option value="25000-30000">25,000ï½30,000ä¸‡å††</option>
                                <option value="30000-">30,000ä¸‡å††ï½</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>å°‚æœ‰é¢ç©ï¼ˆåªï¼‰</label>
                            <select id="sold-filter-area">
                                <option value="">ã™ã¹ã¦</option>
                                <option value="0-10">ï½10åª</option>
                                <option value="10-15">10ï½15åª</option>
                                <option value="15-20">15ï½20åª</option>
                                <option value="20-25">20ï½25åª</option>
                                <option value="25-30">25ï½30åª</option>
                                <option value="30-35">30ï½35åª</option>
                                <option value="35-40">35ï½40åª</option>
                                <option value="40-">40åªï½</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>ç¯‰å¹´æ•°</label>
                            <select id="sold-filter-age">
                                <option value="">ã™ã¹ã¦</option>
                                <option value="0-5">ï½5å¹´</option>
                                <option value="5-10">5ï½10å¹´</option>
                                <option value="10-15">10ï½15å¹´</option>
                                <option value="15-20">15ï½20å¹´</option>
                                <option value="20-25">20ï½25å¹´</option>
                                <option value="25-30">25ï½30å¹´</option>
                                <option value="30-">30å¹´ï½</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <button class="btn btn-primary" onclick="applySoldFilter()">æ¤œç´¢</button>
                        </div>
                        <div class="filter-group">
                            <button class="btn btn-outline" onclick="resetSoldFilter()">ãƒªã‚»ãƒƒãƒˆ</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨çŠ¶æ…‹è¡¨ç¤º -->
            <div id="sold-filter-badge" class="filter-active-badge" style="display:none;">
                ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨ä¸­: <span class="count" id="sold-filtered-count">0</span>ä»¶ / å…¨<span id="sold-total-count">0</span>ä»¶
            </div>

            <!-- æˆç´„çµ±è¨ˆã‚µãƒãƒªãƒ¼ -->
            <div class="card">
                <div class="card-title">æˆç´„çµ±è¨ˆã‚µãƒãƒªãƒ¼</div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">æˆç´„ä»¶æ•°</div>
                        <div class="stat-value"><span id="sold-stat-count">-</span><span class="stat-unit">ä»¶</span></div>
                    </div>
                    <div class="stat-card secondary">
                        <div class="stat-label">æˆç´„ç·é¡</div>
                        <div class="stat-value" id="sold-stat-total">-</div>
                        <div class="stat-unit">å„„å††</div>
                    </div>
                    <div class="stat-card accent">
                        <div class="stat-label">å¹³å‡æˆç´„ä¾¡æ ¼</div>
                        <div class="stat-value" id="sold-stat-avg-price">-</div>
                        <div class="stat-detail" id="sold-stat-price-detail">-</div>
                    </div>
                    <div class="stat-card info">
                        <div class="stat-label">å¹³å‡åªå˜ä¾¡</div>
                        <div class="stat-value" id="sold-stat-avg-sqm">-</div>
                        <div class="stat-detail" id="sold-stat-sqm-detail">-</div>
                    </div>
                </div>
            </div>

            <!-- æˆç´„çµ±è¨ˆã‚°ãƒ©ãƒ• -->
            <div class="charts-grid">
                <div class="card">
                    <div class="card-title">åŒºåˆ¥æˆç´„åˆ†å¸ƒ</div>
                    <div class="chart-container"><canvas id="soldDistrictChart"></canvas></div>
                </div>
                <div class="card">
                    <div class="card-title">ä¾¡æ ¼å¸¯åˆ¥æˆç´„ä»¶æ•°</div>
                    <div class="chart-container"><canvas id="soldPriceRangeChart"></canvas></div>
                </div>
            </div>
            <div class="charts-grid">
                <div class="card">
                    <div class="card-title">æˆç´„æ¨ç§»ï¼ˆæ—¥åˆ¥ï¼‰</div>
                    <div class="chart-container"><canvas id="soldTrendChart"></canvas></div>
                </div>
                <div class="card">
                    <div class="card-title">é–“å–åˆ¥æˆç´„åˆ†å¸ƒ</div>
                    <div class="chart-container"><canvas id="soldLayoutChart"></canvas></div>
                </div>
            </div>
            <div class="charts-grid">
                <div class="card">
                    <div class="card-title">é¢ç©å¸¯åˆ¥ï¼ˆåªï¼‰æˆç´„ä»¶æ•°</div>
                    <div class="chart-container"><canvas id="soldAreaRangeChart"></canvas></div>
                </div>
                <div class="card">
                    <div class="card-title">å°‚æœ‰é¢ç©ï¼ˆåªï¼‰ vs ä¾¡æ ¼ï¼ˆæˆç´„ç‰©ä»¶ï¼‰</div>
                    <div class="chart-container"><canvas id="soldScatterAreaChart"></canvas></div>
                </div>
            </div>

            <!-- å•†å·åˆ¥æˆç´„ãƒ©ãƒ³ã‚­ãƒ³ã‚° -->
            <div class="charts-grid">
                <div class="card">
                    <div class="card-title">æˆç´„ç‰©ä»¶ç·é¡ å•†å·TOP15</div>
                    <div class="chart-container"><canvas id="soldSellerTotalChart"></canvas></div>
                </div>
                <div class="card">
                    <div class="card-title">æˆç´„ç‰©ä»¶æ•° å•†å·TOP15</div>
                    <div class="chart-container"><canvas id="soldSellerCountChart"></canvas></div>
                </div>
            </div>
        </div>

        <!-- è©³ç´°ãƒ‡ãƒ¼ã‚¿ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆï¼‰
        <div id="detail" class="section">
            <div class="card">
                <div class="card-title">ãƒ‡ãƒ¼ã‚¿å®šç¾©</div>
                <div class="table-container" style="max-height:none;"><table><thead><tr><th>é …ç›®å</th><th>èª¬æ˜</th></tr></thead><tbody>
                    <tr><td>ç‰©ä»¶ç•ªå·</td><td>ç‰©ä»¶ã®ä¸€æ„è­˜åˆ¥ç•ªå·</td></tr>
                    <tr><td>ç‰©ä»¶ç¨®ç›®</td><td>ç‰©ä»¶ã®ç¨®é¡ï¼ˆä¸­å¤ãƒãƒ³ã‚·ãƒ§ãƒ³ç­‰ï¼‰</td></tr>
                    <tr><td>å°‚æœ‰é¢ç©</td><td>å°‚æœ‰éƒ¨åˆ†ã®é¢ç©ï¼ˆåªï¼‰â€»å…ƒãƒ‡ãƒ¼ã‚¿ã¯ã¡ã‚’åªã«å¤‰æ›</td></tr>
                    <tr><td>æ‰€åœ¨åœ°</td><td>ç‰©ä»¶ã®æ‰€åœ¨åœ°ä½æ‰€</td></tr>
                    <tr><td>å–å¼•æ…‹æ§˜</td><td>å£²ä¸»ã€ä¸€èˆ¬ã€å°‚ä»»ç­‰ã®å–å¼•å½¢æ…‹</td></tr>
                    <tr><td>ä¾¡æ ¼</td><td>ç‰©ä»¶ã®è²©å£²ä¾¡æ ¼ï¼ˆä¸‡å††ï¼‰</td></tr>
                    <tr><td>ç”¨é€”åœ°åŸŸ</td><td>éƒ½å¸‚è¨ˆç”»æ³•ã«åŸºã¥ãç”¨é€”åœ°åŸŸ</td></tr>
                    <tr><td>åªå˜ä¾¡</td><td>1åªã‚ãŸã‚Šã®ä¾¡æ ¼ï¼ˆä¸‡å††ï¼‰</td></tr>
                    <tr><td>å»ºç‰©å</td><td>ãƒãƒ³ã‚·ãƒ§ãƒ³ç­‰ã®å»ºç‰©åç§°</td></tr>
                    <tr><td>æ‰€åœ¨éš</td><td>ç‰©ä»¶ã®æ‰€åœ¨éš</td></tr>
                    <tr><td>é–“å–</td><td>éƒ¨å±‹ã®é–“å–ã‚Š</td></tr>
                    <tr><td>å–å¼•çŠ¶æ³</td><td>å…¬é–‹ä¸­ã€ç”³è¾¼ã‚ã‚Šã€æˆç´„æ¸ˆã¿ç­‰</td></tr>
                    <tr><td>ç®¡ç†è²»</td><td>æœˆé¡ç®¡ç†è²»ï¼ˆå††ï¼‰</td></tr>
                    <tr><td>æ²¿ç·šé§…</td><td>æœ€å¯„ã‚Šã®æ²¿ç·šãƒ»é§…å</td></tr>
                    <tr><td>äº¤é€š</td><td>é§…ã‹ã‚‰ã®è·é›¢ï¼ˆå¾’æ­©åˆ†æ•°ç­‰ï¼‰</td></tr>
                    <tr><td>å•†å·</td><td>å–æ‰±ä¸å‹•ç”£ä¼šç¤¾å</td></tr>
                    <tr><td>ç¯‰å¹´æœˆ</td><td>å»ºç‰©ã®ç«£å·¥å¹´æœˆ</td></tr>
                    <tr><td>é›»è©±ç•ªå·</td><td>ä¸å‹•ç”£ä¼šç¤¾ã®é€£çµ¡å…ˆ</td></tr>
                </tbody></table></div>
            </div>
        </div>
        -->
    </div>

    <footer><p>Â© 2025 Estate Core - æ±äº¬éƒ½6åŒº ä¸å‹•ç”£ç›¸å ´åˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</p></footer>
    <button class="back-to-top-btn" onclick="scrollToTop()">â†‘ TOP</button>

    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let allRawData = []; // CSVã‹ã‚‰èª­ã¿è¾¼ã‚“ã ç”Ÿãƒ‡ãƒ¼ã‚¿
        let statsFilteredData = []; // çµ±è¨ˆç”¨ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿
        let allProperties = [];
        let filteredProperties = [];
        let currentPage = 1;
        const itemsPerPage = 50;

        // å£²ä¸»ãƒ©ãƒ³ã‚­ãƒ³ã‚°ç”¨ãƒ‡ãƒ¼ã‚¿
        let allSellers = [];

        // æˆç´„æ¸ˆã¿ç‰©ä»¶ç”¨ãƒ‡ãƒ¼ã‚¿
        let allSoldProperties = [];
        let periodFilteredSoldProperties = []; // æœŸé–“ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å¾Œã®ãƒ‡ãƒ¼ã‚¿
        let filteredSoldProperties = [];
        let soldCurrentPage = 1;
        
        // æœŸé–“ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼è¨­å®š
        let currentPeriodUnit = 'all'; // 'all', 'day', 'week', 'month'
        let currentPeriodValue = null; // é¸æŠã•ã‚ŒãŸæœŸé–“ã®å€¤

        const districtColors = {
            "æ¸¯åŒº": "rgba(5, 31, 50, 0.85)",
            "ä¸­å¤®åŒº": "rgba(15, 76, 117, 0.85)",
            "åƒä»£ç”°åŒº": "rgba(45, 139, 122, 0.85)",
            "æ¸‹è°·åŒº": "rgba(201, 169, 98, 0.85)",
            "æ–°å®¿åŒº": "rgba(74, 111, 165, 0.85)",
            "æ–‡äº¬åŒº": "rgba(139, 115, 85, 0.85)"
        };

        const districts = ["æ¸¯åŒº", "ä¸­å¤®åŒº", "åƒä»£ç”°åŒº", "æ¸‹è°·åŒº", "æ–°å®¿åŒº", "æ–‡äº¬åŒº"];

        // Chart.js ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä¿æŒ
        let priceDistChartInstance = null;
        let districtChartInstance = null;
        let scatterAreaChartInstance = null;
        let scatterAgeChartInstance = null;
        let sellerTotalChartInstance = null;
        let sellerCountChartInstance = null;
        
        // æˆç´„æ¸ˆã¿ç‰©ä»¶ç”¨Chart.jsã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
        let soldDistrictChartInstance = null;
        let soldPriceRangeChartInstance = null;
        let soldTrendChartInstance = null;
        let soldLayoutChartInstance = null;
        let soldAreaRangeChartInstance = null;
        let soldScatterAreaChartInstance = null;
        let soldSellerTotalChartInstance = null;
        let soldSellerCountChartInstance = null;

        // æ•°å€¤ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
        function formatNumber(num) { return num.toLocaleString('ja-JP'); }

        // ä¾¡æ ¼æ–‡å­—åˆ—ã‹ã‚‰ã®æ•°å€¤å¤‰æ›
        function parsePrice(priceStr) {
            if (!priceStr) return 0;
            const cleaned = priceStr.replace(/[",ä¸‡å††]/g, '');
            return parseFloat(cleaned) || 0;
        }

        // é¢ç©æ–‡å­—åˆ—ã‹ã‚‰ã®æ•°å€¤å¤‰æ›ï¼ˆã¡ï¼‰
        function parseArea(areaStr) {
            if (!areaStr) return 0;
            const cleaned = areaStr.replace(/[ã¡]/g, '');
            return parseFloat(cleaned) || 0;
        }

        // ã¡ã‹ã‚‰åªã¸ã®å¤‰æ›ï¼ˆ1åª = 3.30579ã¡ï¼‰
        function sqmToTsubo(sqm) {
            return sqm / 3.30579;
        }

        // åªå˜ä¾¡ã‚’è¨ˆç®—ï¼ˆä¸‡å††/åªï¼‰
        function calcTsuboPrice(price, areaSqm) {
            if (!areaSqm || areaSqm <= 0) return 0;
            const tsubo = sqmToTsubo(areaSqm);
            return tsubo > 0 ? price / tsubo : 0;
        }

        // ç¯‰å¹´æ•°è¨ˆç®—
        function calcAge(yearStr) {
            if (!yearStr) return -1;
            const match = yearStr.match(/(\d{4})å¹´/);
            if (match) {
                const year = parseInt(match[1]);
                return new Date().getFullYear() - year;
            }
            return -1;
        }

        // åŒºã‚’æŠ½å‡º
        function extractDistrict(address) {
            for (const d of districts) {
                if (address && address.includes(d)) return d;
            }
            return '';
        }

        // CSVãƒ‘ãƒ¼ã‚¹ï¼ˆç°¡æ˜“ç‰ˆï¼‰
        function parseCSV(text) {
            const lines = text.split('\n');
            const headers = parseCSVLine(lines[0]);
            const data = [];
            for (let i = 1; i < lines.length; i++) {
                if (lines[i].trim() === '') continue;
                const values = parseCSVLine(lines[i]);
                const obj = {};
                headers.forEach((h, idx) => {
                    obj[h] = values[idx] || '';
                });
                data.push(obj);
            }
            return data;
        }

        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;
            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                if (char === '"') {
                    inQuotes = !inQuotes;
                } else if (char === ',' && !inQuotes) {
                    result.push(current.trim());
                    current = '';
                } else {
                    current += char;
                }
            }
            result.push(current.trim());
            return result;
        }

        // ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ‰
        async function loadData() {
            try {
                const response = await fetch('reins_20251207.csv');
                const text = await response.text();
                const rawData = parseCSV(text);
                
                allRawData = rawData.map(row => {
                    const price = parsePrice(row['ä¾¡æ ¼']);
                    const areaSqm = parseArea(row['å°‚æœ‰é¢ç©']);
                    const areaTsubo = sqmToTsubo(areaSqm);
                    const age = calcAge(row['ç¯‰å¹´æœˆ']);
                    const district = extractDistrict(row['æ‰€åœ¨åœ°']);
                    const tsuboPrice = areaTsubo > 0 ? price / areaTsubo : 0;
                    
                    return {
                        id: parseInt(row['ç‰©ä»¶ç•ªå·']) || 0,
                        district: district,
                        building: row['å»ºç‰©å'] || '',
                        floor: row['æ‰€åœ¨éš'] || '',
                        layout: row['é–“å–'] || '',
                        price: price,
                        priceStr: row['ä¾¡æ ¼'] || '',
                        area: areaTsubo,
                        areaSqm: areaSqm,
                        areaStr: areaTsubo.toFixed(2) + 'åª',
                        age: age,
                        status: row['å–å¼•çŠ¶æ³'] || '-',
                        company: row['å•†å·'] || '',
                        torihiki: row['å–å¼•æ…‹æ§˜'] || '',
                        tsuboPrice: tsuboPrice
                    };
                }).filter(d => d.district && d.price > 0);

                statsFilteredData = [...allRawData];
                allProperties = [...allRawData];
                filteredProperties = [...allProperties].sort((a,b) => a.id - b.id);

                // åˆæœŸè¡¨ç¤º
                updateStatsDisplay();
                updateSellerStats();
                renderPropertyList();
                renderUpdateList('yesterday');

                // æˆç´„æ¸ˆã¿ç‰©ä»¶ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿
                await loadSoldData();

                document.getElementById('loadingOverlay').style.display = 'none';
            } catch(e) {
                console.error('ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', e);
                document.getElementById('loadingOverlay').style.display = 'none';
            }
        }

        // çµ±è¨ˆè¡¨ç¤ºæ›´æ–°
        function updateStatsDisplay() {
            const data = statsFilteredData;
            const totalCount = allRawData.length;
            const filteredCount = data.length;

            // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒãƒƒã‚¸è¡¨ç¤º
            const badge = document.getElementById('stats-filter-badge');
            if (filteredCount < totalCount) {
                badge.style.display = 'inline-flex';
                document.getElementById('stats-filtered-count').textContent = formatNumber(filteredCount);
                document.getElementById('stats-total-count').textContent = formatNumber(totalCount);
            } else {
                badge.style.display = 'none';
            }

            if (data.length === 0) {
                document.getElementById('stat-price-avg').textContent = '-';
                document.getElementById('stat-price-detail').textContent = '-';
                document.getElementById('stat-area-avg').textContent = '-';
                document.getElementById('stat-area-detail').textContent = '-';
                document.getElementById('stat-sqm-avg').textContent = '-';
                document.getElementById('stat-sqm-detail').textContent = '-';
                document.getElementById('stat-count').textContent = '0';
                document.getElementById('district-stats-body').innerHTML = '';
                return;
            }

            // ä¾¡æ ¼çµ±è¨ˆ
            const prices = data.map(d => d.price).sort((a,b) => a - b);
            const avgPrice = prices.reduce((a,b) => a+b, 0) / prices.length;
            const medianPrice = prices[Math.floor(prices.length / 2)];
            const minPrice = prices[0];
            const maxPrice = prices[prices.length - 1];

            document.getElementById('stat-price-avg').textContent = formatNumber(Math.round(avgPrice * 10) / 10);
            document.getElementById('stat-price-detail').innerHTML = `ä¸­å¤®å€¤: ${formatNumber(medianPrice)}<br>æœ€å°: ${formatNumber(minPrice)} / æœ€å¤§: ${formatNumber(maxPrice)}`;

            // é¢ç©çµ±è¨ˆ
            const areas = data.map(d => d.area).sort((a,b) => a - b);
            const avgArea = areas.reduce((a,b) => a+b, 0) / areas.length;
            const medianArea = areas[Math.floor(areas.length / 2)];
            const minArea = areas[0];
            const maxArea = areas[areas.length - 1];

            document.getElementById('stat-area-avg').textContent = (Math.round(avgArea * 10) / 10).toFixed(1);
            document.getElementById('stat-area-detail').innerHTML = `ä¸­å¤®å€¤: ${medianArea.toFixed(1)}<br>æœ€å°: ${minArea.toFixed(1)} / æœ€å¤§: ${maxArea.toFixed(1)}`;

            // åªå˜ä¾¡çµ±è¨ˆ
            const tsuboPrices = data.filter(d => d.tsuboPrice > 0).map(d => d.tsuboPrice).sort((a,b) => a - b);
            if (tsuboPrices.length > 0) {
                const avgTsubo = tsuboPrices.reduce((a,b) => a+b, 0) / tsuboPrices.length;
                const medianTsubo = tsuboPrices[Math.floor(tsuboPrices.length / 2)];
                document.getElementById('stat-sqm-avg').textContent = (Math.round(avgTsubo * 10) / 10).toFixed(1);
                document.getElementById('stat-sqm-detail').innerHTML = `ä¸­å¤®å€¤: ${medianTsubo.toFixed(1)}`;
            }

            // ç‰©ä»¶æ•°
            document.getElementById('stat-count').textContent = formatNumber(data.length);

            // åŒºåˆ¥çµ±è¨ˆ
            const districtStatsHtml = districts.map(d => {
                const dData = data.filter(p => p.district === d);
                if (dData.length === 0) return '';
                const dPrices = dData.map(p => p.price).sort((a,b) => a - b);
                const dAvgPrice = dPrices.reduce((a,b) => a+b, 0) / dPrices.length;
                const dMedianPrice = dPrices[Math.floor(dPrices.length / 2)];
                const dAvgArea = dData.map(p => p.area).reduce((a,b) => a+b, 0) / dData.length;
                return `<tr><td>${d}</td><td class="text-right">${formatNumber(dData.length)}</td><td class="text-right">${formatNumber(Math.round(dAvgPrice * 10) / 10)}</td><td class="text-right">${formatNumber(dMedianPrice)}</td><td class="text-right">${dAvgArea.toFixed(1)}</td></tr>`;
            }).join('');
            document.getElementById('district-stats-body').innerHTML = districtStatsHtml;

            // ãƒãƒ£ãƒ¼ãƒˆæ›´æ–°
            updateCharts();
        }

        // ãƒãƒ£ãƒ¼ãƒˆæ›´æ–°
        function updateCharts() {
            const data = statsFilteredData;

            // ä¾¡æ ¼åˆ†å¸ƒ
            const priceRanges = {
                "ã€œ3,000": 0,
                "3,000ã€œ5,000": 0,
                "5,000ã€œ7,000": 0,
                "7,000ã€œ10,000": 0,
                "10,000ã€œ15,000": 0,
                "15,000ã€œ20,000": 0,
                "20,000ã€œ30,000": 0,
                "30,000ã€œ": 0
            };
            data.forEach(d => {
                if (d.price < 3000) priceRanges["ã€œ3,000"]++;
                else if (d.price < 5000) priceRanges["3,000ã€œ5,000"]++;
                else if (d.price < 7000) priceRanges["5,000ã€œ7,000"]++;
                else if (d.price < 10000) priceRanges["7,000ã€œ10,000"]++;
                else if (d.price < 15000) priceRanges["10,000ã€œ15,000"]++;
                else if (d.price < 20000) priceRanges["15,000ã€œ20,000"]++;
                else if (d.price < 30000) priceRanges["20,000ã€œ30,000"]++;
                else priceRanges["30,000ã€œ"]++;
            });

            if (priceDistChartInstance) priceDistChartInstance.destroy();
            priceDistChartInstance = new Chart(document.getElementById('priceDistChart'), {
                type: 'bar',
                data: {
                    labels: Object.keys(priceRanges),
                    datasets: [{ label: 'åœ¨åº«ç‰©ä»¶æ•°', data: Object.values(priceRanges), backgroundColor: 'rgba(5, 31, 50, 0.75)', borderColor: 'rgba(5, 31, 50, 1)', borderWidth: 1 }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { title: { display: true, text: 'ä¾¡æ ¼å¸¯ (ä¸‡å††)' } },
                        y: { beginAtZero: true, title: { display: true, text: 'åœ¨åº«ç‰©ä»¶æ•° (ä»¶)' } }
                    }
                }
            });

            // åŒºåˆ¥ç‰©ä»¶æ•°
            const districtCounts = districts.map(d => data.filter(p => p.district === d).length);
            if (districtChartInstance) districtChartInstance.destroy();
            districtChartInstance = new Chart(document.getElementById('districtChart'), {
                type: 'bar',
                data: {
                    labels: districts,
                    datasets: [{ label: 'åœ¨åº«ç‰©ä»¶æ•°', data: districtCounts, backgroundColor: districts.map(d => districtColors[d]), borderWidth: 1 }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { beginAtZero: true, title: { display: true, text: 'åœ¨åº«ç‰©ä»¶æ•° (ä»¶)' } }
                    }
                }
            });

            // æ•£å¸ƒå›³ï¼ˆé¢ç© vs ä¾¡æ ¼ï¼‰
            if (scatterAreaChartInstance) scatterAreaChartInstance.destroy();
            scatterAreaChartInstance = new Chart(document.getElementById('scatterAreaChart'), {
                type: 'scatter',
                data: {
                    datasets: districts.map(district => ({
                        label: district,
                        data: data.filter(d => d.district === district).map(d => ({ x: d.area, y: d.price })),
                        backgroundColor: districtColors[district],
                        pointRadius: 3
                    }))
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: true, position: 'top', labels: { boxWidth: 12 } } }, scales: { x: { title: { display: true, text: 'å°‚æœ‰é¢ç© (åª)' } }, y: { title: { display: true, text: 'ä¾¡æ ¼ (ä¸‡å††)' } } } }
            });

            // æ•£å¸ƒå›³ï¼ˆç¯‰å¹´æ•° vs ä¾¡æ ¼ï¼‰
            if (scatterAgeChartInstance) scatterAgeChartInstance.destroy();
            scatterAgeChartInstance = new Chart(document.getElementById('scatterAgeChart'), {
                type: 'scatter',
                data: {
                    datasets: districts.map(district => ({
                        label: district,
                        data: data.filter(d => d.district === district && d.age >= 0).map(d => ({ x: d.age, y: d.price })),
                        backgroundColor: districtColors[district],
                        pointRadius: 3
                    }))
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: true, position: 'top', labels: { boxWidth: 12 } } }, scales: { x: { title: { display: true, text: 'ç¯‰å¹´æ•° (å¹´)' } }, y: { title: { display: true, text: 'ä¾¡æ ¼ (ä¸‡å††)' } } } }
            });
        }

        // ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ã®ç¯„å›²å€¤ã‚’ãƒ‘ãƒ¼ã‚¹
        function parseRangeValue(value) {
            if (!value) return { min: 0, max: Infinity };
            const parts = value.split('-');
            const min = parts[0] ? parseFloat(parts[0]) : 0;
            const max = parts[1] ? parseFloat(parts[1]) : Infinity;
            return { min, max };
        }

        // çµ±è¨ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨
        function applyStatsFilter() {
            const torihiki = document.getElementById('stats-filter-torihiki').value;
            const district = document.getElementById('stats-filter-district').value;
            const layout = document.getElementById('stats-filter-layout').value;
            const priceRange = parseRangeValue(document.getElementById('stats-filter-price').value);
            const areaRange = parseRangeValue(document.getElementById('stats-filter-area').value);
            const ageRange = parseRangeValue(document.getElementById('stats-filter-age').value);

            statsFilteredData = allRawData.filter(p => {
                if (torihiki && p.torihiki !== torihiki) return false;
                if (district && p.district !== district) return false;
                if (layout && !p.layout.includes(layout)) return false;
                if (p.price < priceRange.min || p.price > priceRange.max) return false;
                if (p.area < areaRange.min || p.area > areaRange.max) return false;
                if (p.age >= 0 && (p.age < ageRange.min || p.age > ageRange.max)) return false;
                return true;
            });

            updateStatsDisplay();
        }

        // çµ±è¨ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒªã‚»ãƒƒãƒˆ
        function resetStatsFilter() {
            document.getElementById('stats-filter-torihiki').value = '';
            document.getElementById('stats-filter-district').value = '';
            document.getElementById('stats-filter-layout').value = '';
            document.getElementById('stats-filter-price').value = '';
            document.getElementById('stats-filter-area').value = '';
            document.getElementById('stats-filter-age').value = '';
            statsFilteredData = [...allRawData];
            updateStatsDisplay();
        }

        // å•†å·åˆ¥ãƒ©ãƒ³ã‚­ãƒ³ã‚°ç”¨ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿
        let sellerFilteredData = [];

        // å£²ä¸»çµ±è¨ˆæ›´æ–°
        function updateSellerStats(filterDistrict = '', filterTorihiki = '') {
            // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨
            let targetData = allRawData;
            
            if (filterDistrict) {
                targetData = targetData.filter(d => d.district === filterDistrict);
            }
            if (filterTorihiki) {
                targetData = targetData.filter(d => d.torihiki === filterTorihiki);
            }
            
            sellerFilteredData = targetData;
            
            // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒãƒƒã‚¸è¡¨ç¤º
            const badge = document.getElementById('seller-filter-badge');
            const totalCount = allRawData.length;
            const filteredCount = targetData.length;
            
            if (filterDistrict || filterTorihiki) {
                badge.style.display = 'inline-flex';
                document.getElementById('seller-filtered-count').textContent = formatNumber(filteredCount);
                document.getElementById('seller-total-count').textContent = formatNumber(totalCount);
            } else {
                badge.style.display = 'none';
            }
            
            // ã‚¿ã‚¤ãƒˆãƒ«æ›´æ–°
            let titlePrefix = '';
            if (filterTorihiki) {
                titlePrefix = filterTorihiki;
            }
            if (filterDistrict) {
                titlePrefix = titlePrefix ? `${filterDistrict} ${titlePrefix}` : filterDistrict;
            }
            titlePrefix = titlePrefix || '';
            
            const prefix = titlePrefix ? titlePrefix + ' ' : '';
            document.getElementById('seller-total-chart-title').textContent = `${prefix}åœ¨åº«ç‰©ä»¶ç·é¡ TOP15`;
            document.getElementById('seller-count-chart-title').textContent = `${prefix}åœ¨åº«ç‰©ä»¶æ•° TOP15`;
            document.getElementById('seller-ranking-title').textContent = `${prefix}åœ¨åº«ç‰©ä»¶ å•†å·åˆ¥è©³ç´°ãƒ©ãƒ³ã‚­ãƒ³ã‚°`;
            
            // å•†å·åˆ¥é›†è¨ˆ
            const sellerMap = {};
            targetData.forEach(d => {
                if (!sellerMap[d.company]) {
                    sellerMap[d.company] = { total: 0, count: 0 };
                }
                sellerMap[d.company].total += d.price;
                sellerMap[d.company].count++;
            });

            allSellers = Object.entries(sellerMap).map(([company, data]) => ({
                'å•†å·': company,
                'ç‰©ä»¶ç·é¡_å„„å††': data.total / 10000,
                'ç‰©ä»¶æ•°': data.count,
                'å¹³å‡å˜ä¾¡_ä¸‡å††': data.total / data.count
            }));

            // ã‚µãƒãƒªãƒ¼æ›´æ–°
            const companyCount = Object.keys(sellerMap).length;
            const totalAmount = targetData.reduce((a, d) => a + d.price, 0) / 10000;
            const propertyCount = targetData.length;

            document.getElementById('seller-company-count').innerHTML = `${companyCount}<span class="stat-unit">ç¤¾</span>`;
            document.getElementById('seller-total-amount').innerHTML = `${totalAmount.toFixed(1)}<span class="stat-unit">å„„å††</span>`;
            document.getElementById('seller-property-count').innerHTML = `${formatNumber(propertyCount)}<span class="stat-unit">ä»¶</span>`;

            // ãƒãƒ£ãƒ¼ãƒˆæ›´æ–°
            const sellerByTotal = [...allSellers].sort((a, b) => b['ç‰©ä»¶ç·é¡_å„„å††'] - a['ç‰©ä»¶ç·é¡_å„„å††']).slice(0, 15);
            const sellerByCount = [...allSellers].sort((a, b) => b['ç‰©ä»¶æ•°'] - a['ç‰©ä»¶æ•°']).slice(0, 15);

            if (sellerTotalChartInstance) sellerTotalChartInstance.destroy();
            sellerTotalChartInstance = new Chart(document.getElementById('sellerTotalChart'), {
                type: 'bar',
                data: {
                    labels: sellerByTotal.map(d => d['å•†å·'].substring(0, 12) + (d['å•†å·'].length > 12 ? '...' : '')),
                    datasets: [{ label: 'ç·é¡(å„„å††)', data: sellerByTotal.map(d => d['ç‰©ä»¶ç·é¡_å„„å††']), backgroundColor: 'rgba(201, 169, 98, 0.8)', borderWidth: 1 }]
                },
                options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { beginAtZero: true, title: { display: true, text: 'ç‰©ä»¶ç·é¡ (å„„å††)' } } } }
            });

            if (sellerCountChartInstance) sellerCountChartInstance.destroy();
            sellerCountChartInstance = new Chart(document.getElementById('sellerCountChart'), {
                type: 'bar',
                data: {
                    labels: sellerByCount.map(d => d['å•†å·'].substring(0, 12) + (d['å•†å·'].length > 12 ? '...' : '')),
                    datasets: [{ label: 'ä»¶æ•°', data: sellerByCount.map(d => d['ç‰©ä»¶æ•°']), backgroundColor: 'rgba(45, 139, 122, 0.8)', borderWidth: 1 }]
                },
                options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { beginAtZero: true, title: { display: true, text: 'ç‰©ä»¶æ•°' } } } }
            });

            // ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ†ãƒ¼ãƒ–ãƒ«åˆæœŸè¡¨ç¤º
            renderRankingTable('total');
        }

        // å•†å·åˆ¥ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨
        function applySellerFilter() {
            const district = document.getElementById('seller-filter-district').value;
            const torihiki = document.getElementById('seller-filter-torihiki').value;
            updateSellerStats(district, torihiki);
        }

        // å•†å·åˆ¥ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒªã‚»ãƒƒãƒˆ
        function resetSellerFilter() {
            document.getElementById('seller-filter-district').value = '';
            document.getElementById('seller-filter-torihiki').value = '';
            updateSellerStats('', '');
        }

        // ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ†ãƒ¼ãƒ–ãƒ«æç”»
        function renderRankingTable(sortBy = 'total') {
            const tbody = document.getElementById('sellerRankingBody');
            let sortedData;
            if (sortBy === 'total') sortedData = [...allSellers].sort((a,b) => b['ç‰©ä»¶ç·é¡_å„„å††'] - a['ç‰©ä»¶ç·é¡_å„„å††']);
            else if (sortBy === 'count') sortedData = [...allSellers].sort((a,b) => b['ç‰©ä»¶æ•°'] - a['ç‰©ä»¶æ•°']);
            else sortedData = [...allSellers].sort((a,b) => b['å¹³å‡å˜ä¾¡_ä¸‡å††'] - a['å¹³å‡å˜ä¾¡_ä¸‡å††']);
            
            tbody.innerHTML = sortedData.map((item, index) => {
                const rank = index + 1;
                let rankClass = rank === 1 ? 'rank-1' : rank === 2 ? 'rank-2' : rank === 3 ? 'rank-3' : 'rank-other';
                return `<tr><td><span class="rank-badge ${rankClass}">${rank}</span></td><td><span class="company-link" onclick="filterByCompany('${item['å•†å·'].replace(/'/g, "\\'")}')">${item['å•†å·']}</span></td><td class="text-right value-highlight">${item['ç‰©ä»¶ç·é¡_å„„å††'].toFixed(1)}</td><td class="text-right">${item['ç‰©ä»¶æ•°']}</td><td class="text-right">${formatNumber(Math.round(item['å¹³å‡å˜ä¾¡_ä¸‡å††']))}</td></tr>`;
            }).join('');
        }

        // å•†å·ã§ç‰©ä»¶ãƒªã‚¹ãƒˆã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
        function filterByCompany(companyName) {
            switchSection('propertyList');
            document.getElementById('pl-filter-company').value = companyName;
            document.getElementById('pl-filter-notice').textContent = `ã€Œ${companyName}ã€ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ä¸­`;
            applyPropertyFilter();
        }

        // ç‰©ä»¶ãƒªã‚¹ãƒˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨
        function applyPropertyFilter() {
            const district = document.getElementById('pl-filter-district').value;
            const building = document.getElementById('pl-filter-building').value.toLowerCase();
            const company = document.getElementById('pl-filter-company').value.toLowerCase();
            const layout = document.getElementById('pl-filter-layout').value;
            const priceRange = parseRangeValue(document.getElementById('pl-filter-price').value);
            const areaRange = parseRangeValue(document.getElementById('pl-filter-area').value);
            const ageRange = parseRangeValue(document.getElementById('pl-filter-age').value);

            filteredProperties = allProperties.filter(p => {
                if (district && p.district !== district) return false;
                if (building && !p.building.toLowerCase().includes(building)) return false;
                if (company && !p.company.toLowerCase().includes(company)) return false;
                if (layout && !p.layout.includes(layout)) return false;
                if (p.price < priceRange.min || p.price > priceRange.max) return false;
                if (p.area < areaRange.min || p.area > areaRange.max) return false;
                if (p.age >= 0 && (p.age < ageRange.min || p.age > ageRange.max)) return false;
                return true;
            });

            currentPage = 1;
            sortPropertyList();
        }

        // ç‰©ä»¶ãƒªã‚¹ãƒˆãƒªã‚»ãƒƒãƒˆ
        function resetPropertyFilter() {
            document.getElementById('pl-filter-district').value = '';
            document.getElementById('pl-filter-building').value = '';
            document.getElementById('pl-filter-company').value = '';
            document.getElementById('pl-filter-layout').value = '';
            document.getElementById('pl-filter-price').value = '';
            document.getElementById('pl-filter-area').value = '';
            document.getElementById('pl-filter-age').value = '';
            document.getElementById('pl-filter-notice').textContent = '';
            filteredProperties = [...allProperties];
            currentPage = 1;
            sortPropertyList();
        }

        // ç‰©ä»¶ãƒªã‚¹ãƒˆã‚½ãƒ¼ãƒˆ
        function sortPropertyList() {
            const sortValue = document.getElementById('pl-sort-select').value;
            const [field, order] = sortValue.split('-');
            filteredProperties.sort((a, b) => {
                let valA, valB;
                if (field === 'id') { valA = a.id; valB = b.id; }
                else if (field === 'price') { valA = a.price; valB = b.price; }
                else if (field === 'area') { valA = a.area; valB = b.area; }
                return order === 'asc' ? valA - valB : valB - valA;
            });
            currentPage = 1;
            renderPropertyList();
        }

        // ç‰©ä»¶ãƒªã‚¹ãƒˆæç”»
        function renderPropertyList() {
            const tbody = document.getElementById('propertyListBody');
            const totalCount = filteredProperties.length;
            const totalPages = Math.ceil(totalCount / itemsPerPage);
            const start = (currentPage - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            const pageData = filteredProperties.slice(start, end);

            document.getElementById('pl-result-count').textContent = formatNumber(totalCount);

            tbody.innerHTML = pageData.map(p => {
                let statusClass = 'status-active';
                if (p.status === 'ç”³è¾¼ã‚ã‚Š') statusClass = 'status-pending';
                else if (p.status === 'æˆç´„æ¸ˆã¿') statusClass = 'status-sold';
                else if (p.status === 'ä¸€æ™‚åœæ­¢') statusClass = 'status-paused';
                return `<tr><td>${p.id}</td><td>${p.district}</td><td>${p.building}</td><td>${p.floor}</td><td>${p.layout}</td><td class="text-right">${p.priceStr}</td><td class="text-right">${p.areaStr}</td><td class="text-right">${p.age >= 0 ? p.age + 'å¹´' : '-'}</td><td><span class="status-badge ${statusClass}">${p.status === '-' ? 'å…¬é–‹ä¸­' : p.status}</span></td><td>${p.company}</td></tr>`;
            }).join('');

            renderPagination(totalPages);
        }

        // ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³æç”»
        function renderPagination(totalPages) {
            const container = document.getElementById('pl-pagination');
            if (totalPages <= 1) { container.innerHTML = ''; return; }
            
            let html = `<button onclick="goToPage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>â† å‰ã¸</button>`;
            const maxButtons = 5;
            let startPage = Math.max(1, currentPage - Math.floor(maxButtons / 2));
            let endPage = Math.min(totalPages, startPage + maxButtons - 1);
            if (endPage - startPage < maxButtons - 1) startPage = Math.max(1, endPage - maxButtons + 1);

            if (startPage > 1) html += `<button onclick="goToPage(1)">1</button><span>...</span>`;
            for (let i = startPage; i <= endPage; i++) {
                html += `<button onclick="goToPage(${i})" class="${i === currentPage ? 'active' : ''}">${i}</button>`;
            }
            if (endPage < totalPages) html += `<span>...</span><button onclick="goToPage(${totalPages})">${totalPages}</button>`;
            html += `<button onclick="goToPage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>æ¬¡ã¸ â†’</button>`;
            container.innerHTML = html;
        }

        function goToPage(page) { currentPage = page; renderPropertyList(); }

        // CSVå‡ºåŠ›
        function exportPropertyCSV() {
            const headers = ['ç‰©ä»¶ç•ªå·','åŒº','å»ºç‰©å','æ‰€åœ¨éš','é–“å–','ä¾¡æ ¼','å°‚æœ‰é¢ç©(åª)','ç¯‰å¹´æ•°','å–å¼•çŠ¶æ³','å•†å·'];
            const rows = filteredProperties.map(p => [p.id, p.district, p.building, p.floor, p.layout, p.priceStr, p.areaStr, p.age >= 0 ? p.age : '', p.status, p.company]);
            const csv = [headers.join(','), ...rows.map(r => r.map(c => `"${String(c).replace(/"/g, '""')}"`).join(','))].join('\n');
            const blob = new Blob([new Uint8Array([0xEF, 0xBB, 0xBF]), csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'property_list.csv';
            link.click();
        }

        // æ›´æ–°ç‰©ä»¶ãƒªã‚¹ãƒˆæç”»ï¼ˆãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ï¼‰
        function renderUpdateList(period) {
            const demoUpdates = [
                { id: 100137033376, building: 'ï¼´ï¼¨ï¼¥ã€€åƒä»£ç”°éº¹ç”ºã€€ï¼´ï¼¯ï¼·ï¼¥ï¼²', type: 'ä¾¡æ ¼å¤‰æ›´', before: '15,480ä¸‡å††', after: '14,480ä¸‡å††', note: '1,000ä¸‡å††å€¤ä¸‹ã’' },
                { id: 100136640185, building: 'ãƒ‘ãƒ¼ã‚¯ãƒªãƒ¥ã‚¯ã‚¹ç¥ç”°å¤šç”º', type: 'å–å¼•çŠ¶æ³', before: 'å…¬é–‹ä¸­', after: 'ç”³è¾¼ã‚ã‚Š', note: '' },
                { id: 100135826653, building: 'ã‚¯ãƒ¬ã‚¤ã‚·ã‚¢ç¥ç”°æ·¡è·¯ç”º', type: 'å–å¼•çŠ¶æ³', before: 'ç”³è¾¼ã‚ã‚Š', after: 'æˆç´„æ¸ˆã¿', note: 'æˆç´„ã¾ã§32æ—¥' },
                { id: 100136978949, building: 'ãƒ¯ãƒ†ãƒ©ã‚¹ã‚¿ãƒ¯ãƒ¼ãƒ¬ã‚¸ãƒ‡ãƒ³ã‚¹', type: 'ä¾¡æ ¼å¤‰æ›´', before: '29,800ä¸‡å††', after: '28,500ä¸‡å††', note: '1,300ä¸‡å††å€¤ä¸‹ã’' },
                { id: 100137022472, building: 'ç‰æŸ³ãƒ»ãƒ†ã‚·ã‚³å…­ç•ªç”ºãƒ“ãƒ«', type: 'å–å¼•çŠ¶æ³', before: 'å…¬é–‹ä¸­', after: 'æˆç´„æ¸ˆã¿', note: 'æˆç´„ã¾ã§45æ—¥' },
            ];
            
            let filtered = demoUpdates;
            if (period === 'yesterday') filtered = demoUpdates.slice(0, 2);
            else if (period === 'week') filtered = demoUpdates.slice(0, 4);

            document.getElementById('ul-result-count').textContent = filtered.length;
            const tbody = document.getElementById('updateListBody');
            tbody.innerHTML = filtered.map(u => {
                let badge = u.type === 'ä¾¡æ ¼å¤‰æ›´' ? (u.before > u.after ? 'update-price-down' : 'update-price-up') : 'update-status';
                return `<tr><td>${u.id}</td><td>${u.building}</td><td><span class="update-badge ${badge}">${u.type}</span></td><td>${u.before}</td><td style="font-weight:600;">${u.after}</td><td>${u.note}</td></tr>`;
            }).join('');
        }

        // ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³åˆ‡ã‚Šæ›¿ãˆ
        function switchSection(sectionId) {
            document.querySelectorAll('.nav-link').forEach(link => link.classList.remove('active'));
            document.querySelectorAll('.mobile-nav-link').forEach(link => link.classList.remove('active'));
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            
            document.querySelectorAll(`[data-section="${sectionId}"]`).forEach(el => el.classList.add('active'));
            document.getElementById(sectionId).classList.add('active');
            
            // ãƒ¢ãƒã‚¤ãƒ«ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‰ã˜ã‚‹
            document.getElementById('mobileMenu').classList.remove('active');
            document.getElementById('hamburger').classList.remove('active');
        }

        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', () => switchSection(link.dataset.section));
        });

        document.querySelectorAll('.mobile-nav-link').forEach(link => {
            link.addEventListener('click', () => switchSection(link.dataset.section));
        });

        // ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼
        document.getElementById('hamburger').addEventListener('click', () => {
            document.getElementById('hamburger').classList.toggle('active');
            document.getElementById('mobileMenu').classList.toggle('active');
        });

        // ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚¿ãƒ–
        document.querySelectorAll('.ranking-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.ranking-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                renderRankingTable(tab.dataset.sort);
            });
        });

        // æ™‚é–“ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒœã‚¿ãƒ³
        document.querySelectorAll('.time-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.time-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                renderUpdateList(btn.dataset.period);
            });
        });

        // æˆç´„æ¸ˆã¿ç‰©ä»¶ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
        async function loadSoldData() {
            try {
                const response = await fetch('differences_master.csv');
                const text = await response.text();
                const diffData = parseCSV(text);
                
                // å·®åˆ†ç¨®åˆ¥ãŒã€Œå‰Šé™¤ã€ã®ã‚‚ã®ã‚’æˆç´„æ¸ˆã¿ã¨ã—ã¦æŠ½å‡º
                allSoldProperties = diffData
                    .filter(row => row['å·®åˆ†ç¨®åˆ¥'] === 'å‰Šé™¤')
                    .map(row => {
                        const price = parsePrice(row['ä¾¡æ ¼']);
                        const areaSqm = parseArea(row['å°‚æœ‰é¢ç©']);
                        const areaTsubo = sqmToTsubo(areaSqm);
                        const age = calcAge(row['ç¯‰å¹´æœˆ']);
                        const district = extractDistrict(row['æ‰€åœ¨åœ°']);
                        const soldDate = row['å·®åˆ†æ¤œå‡ºæ—¥'] || '';
                        const tsuboPrice = areaTsubo > 0 ? price / areaTsubo : 0;
                        
                        return {
                            id: parseInt(row['ç‰©ä»¶ç•ªå·']) || 0,
                            soldDate: soldDate,
                            district: district,
                            building: row['å»ºç‰©å'] || '',
                            floor: row['æ‰€åœ¨éš'] || '',
                            layout: row['é–“å–'] || '',
                            price: price,
                            priceStr: row['ä¾¡æ ¼'] || '',
                            area: areaTsubo,
                            areaSqm: areaSqm,
                            areaStr: areaTsubo.toFixed(2) + 'åª',
                            age: age,
                            company: row['å•†å·'] || '',
                            torihiki: row['å–å¼•æ…‹æ§˜'] || '',
                            tsuboPrice: tsuboPrice
                        };
                    })
                    .filter(d => d.id > 0);

                // æœŸé–“é¸æŠè‚¢ã‚’ç”Ÿæˆ
                initializePeriodSelector();
                
                // åˆæœŸã¯å…¨æœŸé–“
                periodFilteredSoldProperties = [...allSoldProperties];
                filteredSoldProperties = [...allSoldProperties].sort((a, b) => {
                    // æˆç´„æ—¥ã®æ–°ã—ã„é †ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚½ãƒ¼ãƒˆ
                    if (a.soldDate > b.soldDate) return -1;
                    if (a.soldDate < b.soldDate) return 1;
                    return 0;
                });
                renderSoldList();
            } catch(e) {
                console.log('differences_master.csvèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„å¯èƒ½æ€§ï¼‰:', e);
                // ãƒ•ã‚¡ã‚¤ãƒ«ãŒãªã„å ´åˆã¯ç©ºã§åˆæœŸåŒ–
                allSoldProperties = [];
                periodFilteredSoldProperties = [];
                filteredSoldProperties = [];
                renderSoldList();
            }
        }
        
        // æœŸé–“é¸æŠè‚¢ã®åˆæœŸåŒ–
        function initializePeriodSelector() {
            // ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰æ—¥ä»˜ã®ç¯„å›²ã‚’å–å¾—
            const dates = allSoldProperties.map(p => p.soldDate).filter(d => d).sort();
            if (dates.length === 0) return;
            
            // é€±ã¨æœˆã®é¸æŠè‚¢ã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã®æº–å‚™
            window.availableWeeks = getAvailableWeeks(dates);
            window.availableMonths = getAvailableMonths(dates);
        }
        
        // åˆ©ç”¨å¯èƒ½ãªé€±ã®ãƒªã‚¹ãƒˆã‚’å–å¾—
        function getAvailableWeeks(dates) {
            const weeks = new Set();
            dates.forEach(dateStr => {
                if (!dateStr) return;
                const date = new Date(dateStr);
                const weekInfo = getWeekInfo(date);
                weeks.add(JSON.stringify(weekInfo));
            });
            return Array.from(weeks).map(w => JSON.parse(w)).sort((a, b) => {
                if (a.year !== b.year) return b.year - a.year;
                if (a.month !== b.month) return b.month - a.month;
                return b.week - a.week;
            });
        }
        
        // æ—¥ä»˜ã‹ã‚‰å¹´æœˆé€±æƒ…å ±ã‚’å–å¾—
        function getWeekInfo(date) {
            const year = date.getFullYear();
            const month = date.getMonth() + 1;
            const day = date.getDate();
            const week = Math.ceil(day / 7);
            return { year, month, week };
        }
        
        // é€±ã®é–‹å§‹æ—¥ã¨çµ‚äº†æ—¥ã‚’å–å¾—
        function getWeekDateRange(weekInfo) {
            const { year, month, week } = weekInfo;
            const startDay = (week - 1) * 7 + 1;
            const lastDayOfMonth = new Date(year, month, 0).getDate();
            const endDay = Math.min(week * 7, lastDayOfMonth);
            
            const startDate = `${year}-${String(month).padStart(2, '0')}-${String(startDay).padStart(2, '0')}`;
            const endDate = `${year}-${String(month).padStart(2, '0')}-${String(endDay).padStart(2, '0')}`;
            return { startDate, endDate };
        }
        
        // åˆ©ç”¨å¯èƒ½ãªæœˆã®ãƒªã‚¹ãƒˆã‚’å–å¾—
        function getAvailableMonths(dates) {
            const months = new Set();
            dates.forEach(dateStr => {
                if (!dateStr) return;
                const [year, month] = dateStr.split('-');
                months.add(`${year}-${month}`);
            });
            return Array.from(months).sort().reverse();
        }
        
        // æœŸé–“å˜ä½å¤‰æ›´
        function changePeriodUnit(unit) {
            currentPeriodUnit = unit;
            currentPeriodValue = null;
            
            // ãƒœã‚¿ãƒ³ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ã‚’æ›´æ–°
            document.querySelectorAll('.period-unit-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.unit === unit);
            });
            
            const container = document.getElementById('period-value-container');
            const inputContainer = document.getElementById('period-value-input');
            const label = document.getElementById('period-value-label');
            
            if (unit === 'all') {
                container.style.display = 'none';
                applyPeriodFilter();
                return;
            }
            
            container.style.display = 'block';
            
            if (unit === 'day') {
                label.textContent = 'æ—¥ä»˜é¸æŠ';
                inputContainer.innerHTML = '<input type="date" id="period-date-picker" onchange="onPeriodValueChange()">';
                // æœ€æ–°ã®æ—¥ä»˜ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«
                const dates = allSoldProperties.map(p => p.soldDate).filter(d => d).sort().reverse();
                if (dates.length > 0) {
                    document.getElementById('period-date-picker').value = dates[0];
                    currentPeriodValue = dates[0];
                    applyPeriodFilter();
                }
            } else if (unit === 'week') {
                label.textContent = 'é€±é¸æŠ';
                const weeks = window.availableWeeks || [];
                let options = weeks.map(w => {
                    const value = `${w.year}-${w.month}-${w.week}`;
                    const label = `${w.year}å¹´${w.month}æœˆç¬¬${w.week}é€±ç›®`;
                    return `<option value="${value}">${label}</option>`;
                }).join('');
                inputContainer.innerHTML = `<select id="period-week-picker" onchange="onPeriodValueChange()">${options}</select>`;
                if (weeks.length > 0) {
                    currentPeriodValue = `${weeks[0].year}-${weeks[0].month}-${weeks[0].week}`;
                    applyPeriodFilter();
                }
            } else if (unit === 'month') {
                label.textContent = 'æœˆé¸æŠ';
                const months = window.availableMonths || [];
                let options = months.map(m => {
                    const [year, month] = m.split('-');
                    return `<option value="${m}">${year}å¹´${parseInt(month)}æœˆ</option>`;
                }).join('');
                inputContainer.innerHTML = `<select id="period-month-picker" onchange="onPeriodValueChange()">${options}</select>`;
                if (months.length > 0) {
                    currentPeriodValue = months[0];
                    applyPeriodFilter();
                }
            }
        }
        
        // æœŸé–“å€¤å¤‰æ›´æ™‚
        function onPeriodValueChange() {
            if (currentPeriodUnit === 'day') {
                currentPeriodValue = document.getElementById('period-date-picker').value;
            } else if (currentPeriodUnit === 'week') {
                currentPeriodValue = document.getElementById('period-week-picker').value;
            } else if (currentPeriodUnit === 'month') {
                currentPeriodValue = document.getElementById('period-month-picker').value;
            }
            applyPeriodFilter();
        }
        
        // æœŸé–“ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨
        function applyPeriodFilter() {
            let displayText = 'å…¨æœŸé–“';
            
            if (currentPeriodUnit === 'all' || !currentPeriodValue) {
                periodFilteredSoldProperties = [...allSoldProperties];
                displayText = 'å…¨æœŸé–“';
            } else if (currentPeriodUnit === 'day') {
                periodFilteredSoldProperties = allSoldProperties.filter(p => p.soldDate === currentPeriodValue);
                const [year, month, day] = currentPeriodValue.split('-');
                displayText = `${year}å¹´${parseInt(month)}æœˆ${parseInt(day)}æ—¥`;
            } else if (currentPeriodUnit === 'week') {
                const [year, month, week] = currentPeriodValue.split('-').map(Number);
                const { startDate, endDate } = getWeekDateRange({ year, month, week });
                periodFilteredSoldProperties = allSoldProperties.filter(p => 
                    p.soldDate >= startDate && p.soldDate <= endDate
                );
                displayText = `${year}å¹´${month}æœˆç¬¬${week}é€±ç›®`;
            } else if (currentPeriodUnit === 'month') {
                const [year, month] = currentPeriodValue.split('-');
                periodFilteredSoldProperties = allSoldProperties.filter(p => 
                    p.soldDate && p.soldDate.startsWith(`${year}-${month}`)
                );
                displayText = `${year}å¹´${parseInt(month)}æœˆ`;
            }
            
            // è¡¨ç¤ºæœŸé–“ã‚’æ›´æ–°
            document.getElementById('period-display-value').textContent = displayText;
            
            // æ¤œç´¢æ¡ä»¶ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¦é©ç”¨
            resetSoldFilter();
        }

        // æˆç´„æ¸ˆã¿ç‰©ä»¶ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨
        function applySoldFilter() {
            const torihiki = document.getElementById('sold-filter-torihiki').value;
            const district = document.getElementById('sold-filter-district').value;
            const building = document.getElementById('sold-filter-building').value.toLowerCase();
            const layout = document.getElementById('sold-filter-layout').value;
            const priceRange = parseRangeValue(document.getElementById('sold-filter-price').value);
            const areaRange = parseRangeValue(document.getElementById('sold-filter-area').value);
            const ageRange = parseRangeValue(document.getElementById('sold-filter-age').value);

            // æœŸé–“ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã•ã‚‰ã«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
            filteredSoldProperties = periodFilteredSoldProperties.filter(p => {
                // å–å¼•æ…‹æ§˜ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
                if (torihiki && p.torihiki !== torihiki) return false;
                // åŒºãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
                if (district && p.district !== district) return false;
                // å»ºç‰©åãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
                if (building && !p.building.toLowerCase().includes(building)) return false;
                // é–“å–ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
                if (layout && !p.layout.includes(layout)) return false;
                // ä¾¡æ ¼ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
                if (p.price < priceRange.min || p.price > priceRange.max) return false;
                // é¢ç©ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
                if (p.area < areaRange.min || p.area > areaRange.max) return false;
                // ç¯‰å¹´æ•°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
                if (p.age >= 0 && (p.age < ageRange.min || p.age > ageRange.max)) return false;
                return true;
            });

            // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒãƒƒã‚¸è¡¨ç¤º
            const badge = document.getElementById('sold-filter-badge');
            const totalCount = periodFilteredSoldProperties.length;
            const filteredCount = filteredSoldProperties.length;
            
            if (filteredCount < totalCount) {
                badge.style.display = 'inline-flex';
                document.getElementById('sold-filtered-count').textContent = formatNumber(filteredCount);
                document.getElementById('sold-total-count').textContent = formatNumber(totalCount);
            } else {
                badge.style.display = 'none';
            }

            soldCurrentPage = 1;
            sortSoldList();
        }

        // æˆç´„æ¸ˆã¿ç‰©ä»¶ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒªã‚»ãƒƒãƒˆ
        function resetSoldFilter() {
            document.getElementById('sold-filter-torihiki').value = '';
            document.getElementById('sold-filter-district').value = '';
            document.getElementById('sold-filter-building').value = '';
            document.getElementById('sold-filter-layout').value = '';
            document.getElementById('sold-filter-price').value = '';
            document.getElementById('sold-filter-area').value = '';
            document.getElementById('sold-filter-age').value = '';
            
            // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒãƒƒã‚¸ã‚’éè¡¨ç¤º
            document.getElementById('sold-filter-badge').style.display = 'none';
            
            filteredSoldProperties = [...periodFilteredSoldProperties];
            soldCurrentPage = 1;
            sortSoldList();
        }

        // æˆç´„æ¸ˆã¿ç‰©ä»¶ãƒªã‚¹ãƒˆæç”»
        function renderSoldList() {
            const tbody = document.getElementById('soldListBody');
            const totalCount = filteredSoldProperties.length;
            const totalPages = Math.ceil(totalCount / itemsPerPage);
            const start = (soldCurrentPage - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            const pageData = filteredSoldProperties.slice(start, end);

            document.getElementById('sold-result-count').textContent = formatNumber(totalCount);

            if (totalCount === 0) {
                tbody.innerHTML = '<tr><td colspan="10" style="text-align:center;color:var(--text-secondary);padding:40px;">æˆç´„æ¸ˆã¿ç‰©ä»¶ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</td></tr>';
                document.getElementById('sold-pagination').innerHTML = '';
                return;
            }

            tbody.innerHTML = pageData.map(p => {
                return `<tr><td>${p.soldDate}</td><td>${p.id}</td><td>${p.district}</td><td>${p.building}</td><td>${p.floor}</td><td>${p.layout}</td><td class="text-right">${p.priceStr}</td><td class="text-right">${p.areaStr}</td><td class="text-right">${p.age >= 0 ? p.age + 'å¹´' : '-'}</td><td>${p.company}</td></tr>`;
            }).join('');

            renderSoldPagination(totalPages);
            
            // çµ±è¨ˆã‚°ãƒ©ãƒ•ã‚’æ›´æ–°
            updateSoldStats();
        }

        // æˆç´„æ¸ˆã¿ç‰©ä»¶çµ±è¨ˆãƒ»ã‚°ãƒ©ãƒ•æ›´æ–°
        function updateSoldStats() {
            const data = filteredSoldProperties;
            
            if (data.length === 0) {
                document.getElementById('sold-stat-count').textContent = '0';
                document.getElementById('sold-stat-total').textContent = '-';
                document.getElementById('sold-stat-avg-price').textContent = '-';
                document.getElementById('sold-stat-price-detail').textContent = '-';
                document.getElementById('sold-stat-avg-sqm').textContent = '-';
                document.getElementById('sold-stat-sqm-detail').textContent = '-';
                return;
            }

            // ã‚µãƒãƒªãƒ¼çµ±è¨ˆ
            const totalCount = data.length;
            const totalAmount = data.reduce((sum, d) => sum + d.price, 0);
            const avgPrice = totalAmount / totalCount;
            const prices = data.map(d => d.price).sort((a, b) => a - b);
            const medianPrice = prices[Math.floor(prices.length / 2)];
            
            // åªå˜ä¾¡è¨ˆç®—ï¼ˆareaã¯æ—¢ã«åªå˜ä½ï¼‰
            const tsuboPrices = data.filter(d => d.area > 0).map(d => d.price / d.area);
            const avgTsuboPrice = tsuboPrices.length > 0 ? tsuboPrices.reduce((a, b) => a + b, 0) / tsuboPrices.length : 0;
            const sortedTsubo = [...tsuboPrices].sort((a, b) => a - b);
            const medianTsuboPrice = sortedTsubo.length > 0 ? sortedTsubo[Math.floor(sortedTsubo.length / 2)] : 0;

            document.getElementById('sold-stat-count').textContent = formatNumber(totalCount);
            document.getElementById('sold-stat-total').textContent = (totalAmount / 10000).toFixed(1);
            document.getElementById('sold-stat-avg-price').textContent = formatNumber(Math.round(avgPrice)) + 'ä¸‡å††';
            document.getElementById('sold-stat-price-detail').innerHTML = `ä¸­å¤®å€¤: ${formatNumber(medianPrice)}ä¸‡å††`;
            document.getElementById('sold-stat-avg-sqm').textContent = avgTsuboPrice.toFixed(1) + 'ä¸‡å††';
            document.getElementById('sold-stat-sqm-detail').innerHTML = `ä¸­å¤®å€¤: ${medianTsuboPrice.toFixed(1)}ä¸‡å††`;

            // åŒºåˆ¥æˆç´„ä»¶æ•°ãƒ»ç·é¡ã‚°ãƒ©ãƒ•
            const districtStats = {};
            districts.forEach(d => { districtStats[d] = { count: 0, total: 0 }; });
            data.forEach(d => {
                if (districtStats[d.district]) {
                    districtStats[d.district].count++;
                    districtStats[d.district].total += d.price;
                }
            });

            // åŒºåˆ¥åœ¨åº«ç‰©ä»¶æ•°ã‚’è¨ˆç®—
            const districtInventory = {};
            districts.forEach(d => { districtInventory[d] = 0; });
            allRawData.forEach(d => {
                if (districtInventory[d.district] !== undefined) {
                    districtInventory[d.district]++;
                }
            });

            // åŒºåˆ¥ã®æˆç´„ç‡ï¼ˆåœ¨åº«ã«å ã‚ã‚‹å‰²åˆï¼‰ã‚’è¨ˆç®—
            const districtSoldRatio = districts.map(d => {
                const inventory = districtInventory[d];
                const sold = districtStats[d].count;
                return inventory > 0 ? (sold / inventory * 100) : 0;
            });

            if (soldDistrictChartInstance) soldDistrictChartInstance.destroy();
            soldDistrictChartInstance = new Chart(document.getElementById('soldDistrictChart'), {
                type: 'bar',
                data: {
                    labels: districts,
                    datasets: [
                        {
                            label: 'æˆç´„ä»¶æ•°',
                            data: districts.map(d => districtStats[d].count),
                            backgroundColor: districts.map(d => districtColors[d]),
                            yAxisID: 'y'
                        },
                        {
                            label: 'åœ¨åº«ã«å ã‚ã‚‹å‰²åˆ(%)',
                            data: districtSoldRatio,
                            type: 'line',
                            borderColor: 'rgba(199, 91, 91, 1)',
                            backgroundColor: 'rgba(199, 91, 91, 0.1)',
                            yAxisID: 'y1',
                            tension: 0.3,
                            pointBackgroundColor: 'rgba(199, 91, 91, 1)',
                            pointRadius: 5
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'top' } },
                    scales: {
                        y: { beginAtZero: true, position: 'left', title: { display: true, text: 'æˆç´„ä»¶æ•° (ä»¶)' } },
                        y1: { beginAtZero: true, position: 'right', grid: { drawOnChartArea: false }, title: { display: true, text: 'åœ¨åº«ã«å ã‚ã‚‹å‰²åˆ (%)' } }
                    }
                }
            });

            // ä¾¡æ ¼å¸¯åˆ¥æˆç´„ä»¶æ•°ï¼ˆä»•å…¥ã‚Œåˆ¤æ–­ã«é‡è¦ï¼‰
            const priceRanges = {
                'ï½3,000': 0, '3,000ï½5,000': 0, '5,000ï½7,000': 0, '7,000ï½10,000': 0,
                '10,000ï½15,000': 0, '15,000ï½20,000': 0, '20,000ï½30,000': 0, '30,000ï½': 0
            };
            data.forEach(d => {
                if (d.price < 3000) priceRanges['ï½3,000']++;
                else if (d.price < 5000) priceRanges['3,000ï½5,000']++;
                else if (d.price < 7000) priceRanges['5,000ï½7,000']++;
                else if (d.price < 10000) priceRanges['7,000ï½10,000']++;
                else if (d.price < 15000) priceRanges['10,000ï½15,000']++;
                else if (d.price < 20000) priceRanges['15,000ï½20,000']++;
                else if (d.price < 30000) priceRanges['20,000ï½30,000']++;
                else priceRanges['30,000ï½']++;
            });

            if (soldPriceRangeChartInstance) soldPriceRangeChartInstance.destroy();
            soldPriceRangeChartInstance = new Chart(document.getElementById('soldPriceRangeChart'), {
                type: 'bar',
                data: {
                    labels: Object.keys(priceRanges),
                    datasets: [{
                        label: 'æˆç´„ä»¶æ•°',
                        data: Object.values(priceRanges),
                        backgroundColor: 'rgba(201, 169, 98, 0.8)',
                        borderColor: 'rgba(201, 169, 98, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { 
                        legend: { display: false }
                    },
                    scales: {
                        x: { title: { display: true, text: 'ä¾¡æ ¼å¸¯ (ä¸‡å††)' } },
                        y: { beginAtZero: true, title: { display: true, text: 'æˆç´„ä»¶æ•° (ä»¶)' } }
                    }
                }
            });

            // æˆç´„æ¨ç§»ï¼ˆæ—¥åˆ¥ï¼‰- ãƒãƒ¼ã‚±ãƒƒãƒˆã®å‹•ãã‚’æŠŠæ¡
            const dateStats = {};
            data.forEach(d => {
                if (d.soldDate) {
                    if (!dateStats[d.soldDate]) {
                        dateStats[d.soldDate] = { count: 0, total: 0 };
                    }
                    dateStats[d.soldDate].count++;
                    dateStats[d.soldDate].total += d.price;
                }
            });
            const sortedDates = Object.keys(dateStats).sort();

            if (soldTrendChartInstance) soldTrendChartInstance.destroy();
            soldTrendChartInstance = new Chart(document.getElementById('soldTrendChart'), {
                type: 'line',
                data: {
                    labels: sortedDates,
                    datasets: [
                        {
                            label: 'æˆç´„ä»¶æ•°',
                            data: sortedDates.map(d => dateStats[d].count),
                            borderColor: 'rgba(5, 31, 50, 1)',
                            backgroundColor: 'rgba(5, 31, 50, 0.1)',
                            fill: true,
                            tension: 0.3,
                            yAxisID: 'y'
                        },
                        {
                            label: 'æˆç´„ç·é¡(å„„å††)',
                            data: sortedDates.map(d => dateStats[d].total / 10000),
                            borderColor: 'rgba(45, 139, 122, 1)',
                            backgroundColor: 'rgba(45, 139, 122, 0.1)',
                            fill: false,
                            tension: 0.3,
                            yAxisID: 'y1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'top' } },
                    scales: {
                        x: { title: { display: true, text: 'æˆç´„æ—¥' } },
                        y: { beginAtZero: true, position: 'left', title: { display: true, text: 'ä»¶æ•°' } },
                        y1: { beginAtZero: true, position: 'right', grid: { drawOnChartArea: false }, title: { display: true, text: 'ç·é¡(å„„å††)' } }
                    }
                }
            });

            // é–“å–åˆ¥æˆç´„åˆ†å¸ƒ
            // ã¾ãšåœ¨åº«ç‰©ä»¶ã®é–“å–åˆ¥ä»¶æ•°ã‚’è¨ˆç®—
            const layoutInventory = {};
            allRawData.forEach(d => {
                const layout = d.layout || 'ä¸æ˜';
                if (!layoutInventory[layout]) layoutInventory[layout] = 0;
                layoutInventory[layout]++;
            });

            // æˆç´„ç‰©ä»¶ã®é–“å–åˆ¥ä»¶æ•°ã‚’è¨ˆç®—
            const layoutSold = {};
            data.forEach(d => {
                const layout = d.layout || 'ä¸æ˜';
                if (!layoutSold[layout]) layoutSold[layout] = 0;
                layoutSold[layout]++;
            });

            // å…¨ã¦ã®é–“å–ã‚’ãƒãƒ¼ã‚¸ã—ã¦ä»¶æ•°é †ã«ã‚½ãƒ¼ãƒˆ
            const allLayouts = [...new Set([...Object.keys(layoutInventory), ...Object.keys(layoutSold)])];
            const layoutData = allLayouts.map(layout => ({
                layout: layout,
                sold: layoutSold[layout] || 0,
                inventory: layoutInventory[layout] || 0,
                ratio: layoutInventory[layout] > 0 ? ((layoutSold[layout] || 0) / layoutInventory[layout] * 100) : 0
            })).sort((a, b) => b.sold - a.sold).slice(0, 12); // ä¸Šä½12ä»¶ã¾ã§è¡¨ç¤º

            if (soldLayoutChartInstance) soldLayoutChartInstance.destroy();
            soldLayoutChartInstance = new Chart(document.getElementById('soldLayoutChart'), {
                type: 'bar',
                data: {
                    labels: layoutData.map(d => d.layout),
                    datasets: [
                        {
                            label: 'æˆç´„ä»¶æ•°',
                            data: layoutData.map(d => d.sold),
                            backgroundColor: 'rgba(74, 111, 165, 0.8)',
                            borderColor: 'rgba(74, 111, 165, 1)',
                            borderWidth: 1,
                            yAxisID: 'y'
                        },
                        {
                            label: 'åœ¨åº«ã«å ã‚ã‚‹å‰²åˆ(%)',
                            data: layoutData.map(d => d.ratio),
                            type: 'line',
                            borderColor: 'rgba(199, 91, 91, 1)',
                            backgroundColor: 'rgba(199, 91, 91, 0.1)',
                            yAxisID: 'y1',
                            tension: 0.3,
                            pointBackgroundColor: 'rgba(199, 91, 91, 1)',
                            pointRadius: 5
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { 
                        legend: { position: 'top' },
                        title: { display: true, text: 'é–“å–åˆ¥ã®æˆç´„å‚¾å‘ã¨åœ¨åº«æ¯”ç‡', font: { size: 12 } }
                    },
                    scales: {
                        y: { beginAtZero: true, position: 'left', title: { display: true, text: 'æˆç´„ä»¶æ•° (ä»¶)' } },
                        y1: { beginAtZero: true, position: 'right', grid: { drawOnChartArea: false }, title: { display: true, text: 'åœ¨åº«ã«å ã‚ã‚‹å‰²åˆ (%)' } }
                    }
                }
            });

            // é¢ç©å¸¯åˆ¥æˆç´„ä»¶æ•°ï¼ˆéœ€è¦ã®é«˜ã„é¢ç©å¸¯ã‚’æŠŠæ¡ï¼‰- åªå˜ä½
            const areaRanges = {
                'ï½10åª': 0, '10ï½15åª': 0, '15ï½20åª': 0, '20ï½30åª': 0, '30åªï½': 0
            };
            data.forEach(d => {
                if (d.area <= 10) areaRanges['ï½10åª']++;
                else if (d.area <= 15) areaRanges['10ï½15åª']++;
                else if (d.area <= 20) areaRanges['15ï½20åª']++;
                else if (d.area <= 30) areaRanges['20ï½30åª']++;
                else areaRanges['30åªï½']++;
            });

            if (soldAreaRangeChartInstance) soldAreaRangeChartInstance.destroy();
            soldAreaRangeChartInstance = new Chart(document.getElementById('soldAreaRangeChart'), {
                type: 'doughnut',
                data: {
                    labels: Object.keys(areaRanges),
                    datasets: [{
                        data: Object.values(areaRanges),
                        backgroundColor: [
                            'rgba(5, 31, 50, 0.85)',
                            'rgba(15, 76, 117, 0.85)',
                            'rgba(45, 139, 122, 0.85)',
                            'rgba(201, 169, 98, 0.85)',
                            'rgba(139, 115, 85, 0.85)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'right' },
                        title: { display: true, text: 'éœ€è¦ã®é«˜ã„é¢ç©å¸¯ï¼ˆåªï¼‰', font: { size: 12 } }
                    }
                }
            });

            // å°‚æœ‰é¢ç©ï¼ˆåªï¼‰ vs ä¾¡æ ¼ æ•£å¸ƒå›³ï¼ˆæˆç´„ç‰©ä»¶ï¼‰
            if (soldScatterAreaChartInstance) soldScatterAreaChartInstance.destroy();
            soldScatterAreaChartInstance = new Chart(document.getElementById('soldScatterAreaChart'), {
                type: 'scatter',
                data: {
                    datasets: districts.map(district => ({
                        label: district,
                        data: data.filter(d => d.district === district).map(d => ({ x: d.area, y: d.price })),
                        backgroundColor: districtColors[district],
                        pointRadius: 4
                    }))
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: true, position: 'top', labels: { boxWidth: 12 } }
                    },
                    scales: {
                        x: { title: { display: true, text: 'å°‚æœ‰é¢ç© (åª)' } },
                        y: { title: { display: true, text: 'ä¾¡æ ¼ (ä¸‡å††)' } }
                    }
                }
            });

            // å•†å·åˆ¥æˆç´„ãƒ©ãƒ³ã‚­ãƒ³ã‚°
            const sellerStats = {};
            data.forEach(d => {
                const company = d.company || 'ä¸æ˜';
                if (!sellerStats[company]) {
                    sellerStats[company] = { count: 0, total: 0 };
                }
                sellerStats[company].count++;
                sellerStats[company].total += d.price;
            });

            // ç·é¡é †TOP15
            const sellerByTotal = Object.entries(sellerStats)
                .map(([company, stats]) => ({ company, ...stats }))
                .sort((a, b) => b.total - a.total)
                .slice(0, 15);

            // ä»¶æ•°é †TOP15
            const sellerByCount = Object.entries(sellerStats)
                .map(([company, stats]) => ({ company, ...stats }))
                .sort((a, b) => b.count - a.count)
                .slice(0, 15);

            if (soldSellerTotalChartInstance) soldSellerTotalChartInstance.destroy();
            soldSellerTotalChartInstance = new Chart(document.getElementById('soldSellerTotalChart'), {
                type: 'bar',
                data: {
                    labels: sellerByTotal.map(d => d.company.substring(0, 12) + (d.company.length > 12 ? '...' : '')),
                    datasets: [{
                        label: 'æˆç´„ç·é¡(å„„å††)',
                        data: sellerByTotal.map(d => d.total / 10000),
                        backgroundColor: 'rgba(201, 169, 98, 0.8)',
                        borderColor: 'rgba(201, 169, 98, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                afterLabel: function(context) {
                                    const idx = context.dataIndex;
                                    return `ä»¶æ•°: ${sellerByTotal[idx].count}ä»¶`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: { beginAtZero: true, title: { display: true, text: 'æˆç´„ç·é¡ (å„„å††)' } }
                    }
                }
            });

            if (soldSellerCountChartInstance) soldSellerCountChartInstance.destroy();
            soldSellerCountChartInstance = new Chart(document.getElementById('soldSellerCountChart'), {
                type: 'bar',
                data: {
                    labels: sellerByCount.map(d => d.company.substring(0, 12) + (d.company.length > 12 ? '...' : '')),
                    datasets: [{
                        label: 'æˆç´„ä»¶æ•°',
                        data: sellerByCount.map(d => d.count),
                        backgroundColor: 'rgba(45, 139, 122, 0.8)',
                        borderColor: 'rgba(45, 139, 122, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                afterLabel: function(context) {
                                    const idx = context.dataIndex;
                                    return `ç·é¡: ${(sellerByCount[idx].total / 10000).toFixed(1)}å„„å††`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: { beginAtZero: true, title: { display: true, text: 'æˆç´„ä»¶æ•°' } }
                    }
                }
            });
        }

        // æˆç´„æ¸ˆã¿ç‰©ä»¶ãƒªã‚¹ãƒˆç”¨ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨
        function applySoldListFilter() {
            const district = document.getElementById('sold-list-filter-district').value;
            const building = document.getElementById('sold-list-filter-building').value.toLowerCase();
            const company = document.getElementById('sold-list-filter-company').value.toLowerCase();
            const layout = document.getElementById('sold-list-filter-layout').value;
            const priceRange = parseRangeValue(document.getElementById('sold-list-filter-price').value);
            const areaRange = parseRangeValue(document.getElementById('sold-list-filter-area').value);
            const ageRange = parseRangeValue(document.getElementById('sold-list-filter-age').value);

            filteredSoldProperties = allSoldProperties.filter(p => {
                if (district && p.district !== district) return false;
                if (building && !p.building.toLowerCase().includes(building)) return false;
                if (company && !p.company.toLowerCase().includes(company)) return false;
                if (layout && !p.layout.includes(layout)) return false;
                if (p.price < priceRange.min || p.price > priceRange.max) return false;
                if (p.area < areaRange.min || p.area > areaRange.max) return false;
                if (p.age >= 0 && (p.age < ageRange.min || p.age > ageRange.max)) return false;
                return true;
            });

            // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é€šçŸ¥è¡¨ç¤º
            const totalCount = allSoldProperties.length;
            const filteredCount = filteredSoldProperties.length;
            if (filteredCount < totalCount) {
                document.getElementById('sold-list-filter-notice').textContent = `(ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨ä¸­: å…¨${formatNumber(totalCount)}ä»¶ä¸­)`;
            } else {
                document.getElementById('sold-list-filter-notice').textContent = '';
            }

            soldCurrentPage = 1;
            sortSoldList();
        }

        // æˆç´„æ¸ˆã¿ç‰©ä»¶ãƒªã‚¹ãƒˆç”¨ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒªã‚»ãƒƒãƒˆ
        function resetSoldListFilter() {
            document.getElementById('sold-list-filter-district').value = '';
            document.getElementById('sold-list-filter-building').value = '';
            document.getElementById('sold-list-filter-company').value = '';
            document.getElementById('sold-list-filter-layout').value = '';
            document.getElementById('sold-list-filter-price').value = '';
            document.getElementById('sold-list-filter-area').value = '';
            document.getElementById('sold-list-filter-age').value = '';
            document.getElementById('sold-list-filter-notice').textContent = '';
            filteredSoldProperties = [...allSoldProperties];
            soldCurrentPage = 1;
            sortSoldList();
        }

        // æˆç´„æ¸ˆã¿ç‰©ä»¶ã‚½ãƒ¼ãƒˆ
        function sortSoldList() {
            const sortValue = document.getElementById('sold-sort-select').value;
            const [field, order] = sortValue.split('-');
            filteredSoldProperties.sort((a, b) => {
                let valA, valB;
                if (field === 'id') { valA = a.id; valB = b.id; }
                else if (field === 'price') { valA = a.price; valB = b.price; }
                else if (field === 'soldDate') { valA = a.soldDate; valB = b.soldDate; }
                
                if (field === 'soldDate') {
                    // æ—¥ä»˜æ–‡å­—åˆ—ã®æ¯”è¼ƒ
                    if (valA > valB) return order === 'asc' ? 1 : -1;
                    if (valA < valB) return order === 'asc' ? -1 : 1;
                    return 0;
                }
                return order === 'asc' ? valA - valB : valB - valA;
            });
            soldCurrentPage = 1;
            renderSoldList();
        }

        // æˆç´„æ¸ˆã¿ç‰©ä»¶ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³æç”»
        function renderSoldPagination(totalPages) {
            const container = document.getElementById('sold-pagination');
            if (totalPages <= 1) { container.innerHTML = ''; return; }
            
            let html = `<button onclick="goToSoldPage(${soldCurrentPage - 1})" ${soldCurrentPage === 1 ? 'disabled' : ''}>â† å‰ã¸</button>`;
            const maxButtons = 5;
            let startPage = Math.max(1, soldCurrentPage - Math.floor(maxButtons / 2));
            let endPage = Math.min(totalPages, startPage + maxButtons - 1);
            if (endPage - startPage < maxButtons - 1) startPage = Math.max(1, endPage - maxButtons + 1);

            if (startPage > 1) html += `<button onclick="goToSoldPage(1)">1</button><span>...</span>`;
            for (let i = startPage; i <= endPage; i++) {
                html += `<button onclick="goToSoldPage(${i})" class="${i === soldCurrentPage ? 'active' : ''}">${i}</button>`;
            }
            if (endPage < totalPages) html += `<span>...</span><button onclick="goToSoldPage(${totalPages})">${totalPages}</button>`;
            html += `<button onclick="goToSoldPage(${soldCurrentPage + 1})" ${soldCurrentPage === totalPages ? 'disabled' : ''}>æ¬¡ã¸ â†’</button>`;
            container.innerHTML = html;
        }

        function goToSoldPage(page) { soldCurrentPage = page; renderSoldList(); }

        // æˆç´„æ¸ˆã¿ç‰©ä»¶CSVå‡ºåŠ›
        function exportSoldCSV() {
            const headers = ['æˆç´„æ—¥','ç‰©ä»¶ç•ªå·','åŒº','å»ºç‰©å','æ‰€åœ¨éš','é–“å–','ä¾¡æ ¼','å°‚æœ‰é¢ç©(åª)','ç¯‰å¹´æ•°','å•†å·'];
            const rows = filteredSoldProperties.map(p => [p.soldDate, p.id, p.district, p.building, p.floor, p.layout, p.priceStr, p.areaStr, p.age >= 0 ? p.age : '', p.company]);
            const csv = [headers.join(','), ...rows.map(r => r.map(c => `"${String(c).replace(/"/g, '""')}"`).join(','))].join('\n');
            const blob = new Blob([new Uint8Array([0xEF, 0xBB, 0xBF]), csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'sold_properties.csv';
            link.click();
        }

        // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ãƒˆã‚°ãƒ«
        function toggleFilter(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                section.classList.toggle('collapsed');
                // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®é«˜ã•ã‚’è¨­å®š
                const content = section.querySelector('.filter-content');
                if (content) {
                    if (section.classList.contains('collapsed')) {
                        content.style.maxHeight = '0';
                    } else {
                        content.style.maxHeight = content.scrollHeight + 'px';
                    }
                }
            }
        }

        // ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–æ™‚ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼åˆæœŸåŒ–
        function initFilterAccordions() {
            const isMobile = window.innerWidth <= 768;
            document.querySelectorAll('.filter-section').forEach(section => {
                const content = section.querySelector('.filter-content');
                if (content) {
                    if (isMobile) {
                        // ãƒ¢ãƒã‚¤ãƒ«ã§ã¯é–‰ã˜ãŸçŠ¶æ…‹ã§é–‹å§‹
                        section.classList.add('collapsed');
                        content.style.maxHeight = '0';
                    } else {
                        // ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã§ã¯é–‹ã„ãŸçŠ¶æ…‹
                        section.classList.remove('collapsed');
                        content.style.maxHeight = 'none';
                    }
                }
            });
        }

        // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒªã‚µã‚¤ã‚ºæ™‚ã®å‡¦ç†
        window.addEventListener('resize', () => {
            initFilterAccordions();
        });

        // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒˆãƒƒãƒ—
        function scrollToTop() { window.scrollTo({ top: 0, behavior: 'smooth' }); }
        window.addEventListener('scroll', () => {
            const btn = document.querySelector('.back-to-top-btn');
            btn.style.display = window.scrollY > 300 ? 'block' : 'none';
        });

        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', () => {
            loadData();
            initFilterAccordions();
        });
    </script>
</body>
</html>
